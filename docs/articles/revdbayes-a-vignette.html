<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis • revdbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/EVA2021revdbayes.html">EVA 2021 R Workshop: revdbayes</a>
    </li>
    <li>
      <a href="../articles/ex1revdbayes.html">EVA 2021 revdbayes exercises 1</a>
    </li>
    <li>
      <a href="../articles/ex2revdbayes.html">EVA 2021 revdbayes exercises 2</a>
    </li>
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using threshold interexceedance times</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/revdbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introducing revdbayes: Ratio-of-Uniforms
Sampling for Bayesian Extreme Value Analysis</h1>
                        <h4 data-toc-skip class="author">Paul J.
Northrop</h4>
            
            <h4 data-toc-skip class="date">2025-12-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/revdbayes/blob/HEAD/vignettes/revdbayes-a-vignette.Rmd" class="external-link"><code>vignettes/revdbayes-a-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>revdbayes-a-vignette.Rmd</code></div>

    </div>

    
    
<p>This vignette focuses on random sampling from extreme value posterior
distributions using the function <code>rpost</code>. From version 1.2.0
onwards sampling can be achieved more quickly using the function
<code>rpost_rcpp</code>. See the vignette <a href="revdbayes-b-using-rcpp-vignette.html">Faster simulation using
revdbayes</a> for details.</p>
<p>Performing posterior predictive extreme value inference using
posterior samples is covered in a separate vignette <a href="revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme
Value Inference using the revdbayes Package</a></p>
<div class="section level3">
<h3 id="the-revdbayes-package">The <em>revdbayes</em> package<a class="anchor" aria-label="anchor" href="#the-revdbayes-package"></a>
</h3>
<p>The <em>revdbayes</em> package tackles the same problem as the
<em>evdbayes</em> package <span class="citation">(Stephenson and Ribatet
2014)</span>, that is, sampling from posterior distributions that occur
in some relatively simple Bayesian extreme value analyses. The essential
difference between these two packages is that evdbayes performs sampling
using Markov Chain Monte Carlo (MCMC) techniques, whereas revdbayes uses
the generalised ratio-of-uniforms method <span class="citation">(Wakefield, Gelfand, and Smith 1991)</span>,
implemented using the <em>rust</em> package <span class="citation">(Northrop 2017)</span>. Otherwise, these two packages
have similar functionality and their functions have a similar syntax.
For example, a prior distribution specified using one package may be
used in posterior sampling implemented by the other. For details of
setting prior distributions see the <code>set_prior</code> function.</p>
<p>For details of Bayesian extreme value analyses see the review of
<span class="citation">Stephenson (2016)</span> and the evdbayes user
guide (available in the evdbayes doc directory). Typically, MCMC is used
to sample from extreme value posterior distributions. This requires
tuning parameters of the MCMC algorithm to be set and results in a
dependent sample from the posterior. Diagnostics checks, based on
running multiple chains from different starting values, are used to
check convergence and to decide which values should be discarded prior
to approximate convergence. An advantage of using a direct method of
simulation, such as the generalised ratio-of-uniforms method, is that it
produces a random sample from the posterior distribution. This method
also involves tuning parameters, but the revdbayes package has been
designed to set those automatically.</p>
<p>The current version of revdbayes samples from posterior distributions
based on the Generalised Extreme Value (GEV) model, the Generalised
Pareto (GP) model, the point process (PP) model and the
<em>r</em>-largest order statistics (OS) model. The evdbayes package
offers in addition some extreme value regression models.</p>
<p>We consider how to use the two main functions in revdbayes, namely
<code>set_prior</code> (used to define the prior distribution) and
<code>rpost</code> (used to sample from the posterior distribution). We
use the examples in the evdbayes user guide for illustration. Please see
the evdbayes user guide for details of the models underlying these
analyses.</p>
</div>
<div class="section level3">
<h3 id="the-ratio-of-uniforms-method">The ratio-of-uniforms method<a class="anchor" aria-label="anchor" href="#the-ratio-of-uniforms-method"></a>
</h3>
<p>The ratio-of-uniforms method is an acceptance-rejection type of
simulation algorithm. A crude measure of the efficiency of the algorithm
is the probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
that a proposed value is accepted. In the <em>rust</em> package <span class="citation">(Northrop 2017)</span> variable transformation is used
to increase
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>.
In the current context two transformations are of interest: (i) marginal
Box-Cox transformation of (positive functions of) extreme value
parameters (using argument <code>trans = "BC"</code> to
<code>rpost</code> instead of the default <code>trans = "none"</code>),
and/or (ii) rotation of parameter axes about the estimated mode of the
posterior (the default <code>rotate = TRUE</code> instead of the
<code>rotate = FALSE</code>), based on the estimated Hessian of the
log-posterior at this mode. Transformation (i) seeks to reduce skewness
in the marginal posterior distributions. Transformation (ii) tends to
reduce posterior dependence between the parameters. The
ratio-of-uniforms algorithm is then performed after relocating the mode
of the posterior to the origin, because this tends to increase the
probability of acceptance <span class="citation">(Wakefield, Gelfand,
and Smith 1991)</span>.</p>
<p>For details of the ratio-of-uniforms method and the transformations
used see the vignette of the <em>rust</em> package <span class="citation">(Northrop 2017)</span>. In the <em>rust</em> vignette
it is argued that the largest attainable value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
for a typical
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
problem is the value resulting from the special case of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
normal distribution with independent components. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d=2</annotation></semantics></math>
this value is 0.534, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d=3</annotation></semantics></math>
the value is 0.316. In an object <code>ru_object</code> returned from
<code>rpost</code> an estimate of this probability is given by
<code>ru_object$pa</code>. The examples presented in this vignette
suggest that often rotation to reduce dependence is more helpful than
marginal transformation to reduce skewness. This
(<code>trans = "none"</code> and <code>rotate = TRUE</code>) is the
default setting of <code>rpost</code> and seems to work well enough for
most problems.</p>
<p>The computations in the following sections were performed using a
notebook containing a 3.0GHz Intel processor and 8GB RAM.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/" class="external-link">revdbayes</a></span><span class="op">)</span></span>
<span><span class="co"># Set the number of posterior samples required.</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">46</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generalised-pareto-gp-model">Generalised Pareto (GP) model<a class="anchor" aria-label="anchor" href="#generalised-pareto-gp-model"></a>
</h2>
<p>The GP distribution is used to model <em>threshold excesses</em>,
that is, the amounts by which <em>threshold exceedances</em> exceed some
threshold. It has two parameters: a scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>u</mi></msub><annotation encoding="application/x-tex">\sigma_u</annotation></semantics></math>
and shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>.
We use the following example to illustrate the use of the transformation
strategies implemented by the arguments <code>rotate</code> and
<code>trans</code> to <code>rpost</code> and how the user can specify
their own prior distribution.</p>
<div class="section level3">
<h3 id="gulf-of-mexico-wave-height-data">Gulf of Mexico Wave Height Data<a class="anchor" aria-label="anchor" href="#gulf-of-mexico-wave-height-data"></a>
</h3>
<p>The numeric vector <code>gom</code> contains 315 storm peak
significant wave heights from a location in the Gulf of Mexico, from the
years 1900 to 2005. These data are analysed in <span class="citation">Northrop, Attalides, and Jonathan (2017)</span>. We set
the threshold at the 65% sample quantile and use <code>set_prior</code>
to set a prior.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span></span>
<span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We sample first on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
scale, with mode relocation only.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span>,</span>
<span>             rotate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>Then we add a rotation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
about the estimated posterior mode.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>Now we add marginal Box-Cox transformation. We apply Box-Cox
transformation to the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><msub><mi>σ</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\phi_1 = \sigma_u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub><mo>=</mo><mi>ξ</mi><mo>+</mo><mi>σ</mi><mi>/</mi><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\phi_2 = \xi + \sigma / x_{(m)}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(m)}</annotation></semantics></math>
is the largest threshold excess. The parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
are positive for all combinations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
for which the GP likelihood is positive.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span>,</span>
<span>             rotate <span class="op">=</span> <span class="cn">FALSE</span>, trans <span class="op">=</span> <span class="st">"BC"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">t4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span>,</span>
<span>             trans <span class="op">=</span> <span class="st">"BC"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>We plot the samples obtained with the contours of the corresponding
densities superimposed. The plot on the top left is on the original
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
scale. The other plots are on the scale used for the ratio-of-uniforms
algorithm, that is, with relocation of the mode to the origin. In the
following the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">\rho_i, i = 1, \ldots, d</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\rho_2</annotation></semantics></math>
in this example, are the variables to which the ratio-of-uniforms
algorithm is applied, i.e. after any transformation (Box-Cox and/or
rotation of axes) and relocation of the mode to the origin.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gp1</span>, ru_scale <span class="op">=</span> <span class="cn">FALSE</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"no transformation \n pa = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gp1</span><span class="op">$</span><span class="va">pa</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>               <span class="st">", time = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">t1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gp2</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"rotation \n pa = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gp2</span><span class="op">$</span><span class="va">pa</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               <span class="st">", time = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">t2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gp3</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Box-Cox \n pa = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gp3</span><span class="op">$</span><span class="va">pa</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               <span class="st">", time = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">t3</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gp4</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Box-Cox and rotation \n pa = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gp4</span><span class="op">$</span><span class="va">pa</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>               <span class="st">", time = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">t4</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-7-1.png" width="45%"><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-7-2.png" width="45%"><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-7-3.png" width="45%"><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-7-4.png" width="45%"></p>
<p>Comparison of the plots on the right to the plots on the left shows
that rotation of the parameter axes about the mode of the posterior has
reduced dependence between the components. The estimated probabilities
of acceptance for the plots on the right are close to the 0.534 obtained
for a 2-dimensional normal distribution with independent components.
Box-Cox transformation has increased the estimated value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
but not by much. In fact, the extra computation time required to
calculate the Box-Cox transformation each time that the posterior
density is evaluated means that posterior sampling is slower than the
default setting of <code>rotate = TRUE</code> and
<code>trans = "none"</code>. That is, in this example at least, the
increase is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
resulting from the addition of the Box-Cox transformation is not
sufficient to offset the extra time needed to compute the posterior
density.</p>
<p>We repeat the rotation only and Box-Cox transformation plus rotation
analyses for a much higher threshold, set at the 95% sample
quantile.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">t4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">gp4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span>,</span>
<span>             trans <span class="op">=</span> <span class="st">"BC"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<p>It is optimistic to use such a high threshold in this example,
because it results in only 16 threshold excesses. In the rotation only
case, a convergence warning is triggered by one of the optimisations
used to created the bounding box of the ratio-of-uniforms method. This
appears to be a spurious warning, because the plots of the simulations
below seem fine. When a Box-Cox transformation is used there are no
warnings, because the optimisations have greater stability and it is now
easier for the convergence of the optimisations to be confirmed.</p>
<p>Strong asymmetry in the posterior distribution means that the
combination of marginal Box-Cox transformation and rotation produces a
larger improvement in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
and means that now this strategy is competitive with using rotation
alone in terms of computation time.</p>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-9-1.png" width="45%"><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-9-2.png" width="45%"></p>
<p><strong>A User-defined prior</strong></p>
<p>Suppose that we wish to use a prior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
with a density that is proportional to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>u</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\sigma_u^{-1} (1+\xi)^{\alpha-1} (1-\xi)^{\beta-1}</annotation></semantics></math>,
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>u</mi></msub><mo>&gt;</mo><mn>0</mn><mo>,</mo><mi>−</mi><mn>1</mn><mo>&lt;</mo><mi>ξ</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma_u &gt; 0, -1 &lt; \xi &lt; 1</annotation></semantics></math>
and for some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta &gt; 0</annotation></semantics></math>.
This is an improper prior in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>u</mi></msub><annotation encoding="application/x-tex">\sigma_u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
are independent <em>a priori</em>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>σ</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\log \sigma_u</annotation></semantics></math>
is uniform over the real line and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
has
beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha, \beta</annotation></semantics></math>)-type
distribution on the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(-1, 1)</annotation></semantics></math>.
We can do this by creating a function that returns the prior log-density
and passing this function to <code>set_prior</code>. The first argument
of the prior log-density function must be the parameter vector (the GP
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>σ</mi><mi>u</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\sigma_u, \xi)</annotation></semantics></math>
in this case), followed by any hyperparameters.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u_prior_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">ab</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Calculates the the log of the (improper) prior density for GP parameters </span></span>
<span>  <span class="co"># (sigma_u, xi) in which log(sigma_u) is uniform on the real line and xi has </span></span>
<span>  <span class="co"># a beta(alpha, beta)-type prior on the interval (-1, 1).</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Args:</span></span>
<span>  <span class="co">#   x  : A numeric vector.  GP parameter vector (sigma, xi).</span></span>
<span>  <span class="co">#   ab : A numeric vector.  Hyperparameter vector (alpha, beta), where</span></span>
<span>  <span class="co">#        alpha and beta must be positive.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="co"># Returns : the value of the log-prior at x.</span></span>
<span>  <span class="co">#</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">}</span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">ab</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="op">(</span><span class="va">ab</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">up</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">u_prior_fn</span>, ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"gp"</span><span class="op">)</span></span>
<span><span class="va">gp_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">up</span>, thresh <span class="op">=</span> <span class="va">thresh</span>, data <span class="op">=</span> <span class="va">gom</span><span class="op">)</span></span></code></pre></div>
<p>See also the “Posterior predictive extreme value inference” section
of the <a href="revdbayes-c-predictive-vignette.html">Posterior
Predictive Extreme Value Inference using the revdbayes Package</a> for
an analysis that adds inferences about the probability of threshold
exceedance to the analysis of threshold excesses using a GP
distribution.</p>
</div>
</div>
<div class="section level2">
<h2 id="generalised-extreme-value-gev-model">Generalised Extreme Value (GEV) model<a class="anchor" aria-label="anchor" href="#generalised-extreme-value-gev-model"></a>
</h2>
<p>We consider two examples involving the GEV distribution, which is
used to model block maxima. The GEV distribution has three parameters: a
location parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
a scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and a shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>.
In the first example we illustrate the use of <code>set_prior</code> to
set a prior distribution for the GEV parameters and show that a prior
set using <code>set_prior</code> (including user-defined prior) can be
used as an argument to the evdbayes function <code>posterior</code>. In
the second example we show that the reverse is also true, that is, a
prior set using an evdbayes function (<code>prior.prob</code>) can be
used an an argument to the revdbayes function <code>rpost</code>.</p>
<div class="section level3">
<h3 id="port-pirie-sea-level-data">Port Pirie Sea Level Data<a class="anchor" aria-label="anchor" href="#port-pirie-sea-level-data"></a>
</h3>
<p>The numeric vector <code>portpirie</code> contains 65 annual maximum
sea levels (in metres) recorded at Port Pirie, South Australia, from
1923 to 1987.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">portpirie</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pn</span>, data <span class="op">=</span> <span class="va">portpirie</span><span class="op">)</span></span>
<span><span class="va">p1</span><span class="op">$</span><span class="va">pa</span></span>
<span><span class="co">#&gt; [1] 0.2981159</span></span></code></pre></div>
<p>The proportion of accepted values is close to the best we can hope
for in this 3-dimensional example, i.e. 0.316. The following plots
illustrate the effect of <code>rotate = TRUE</code>. The first set of
plots below show the simulated values of the GEV parameters. There is
some association between the parameters <em>a posteriori</em>, albeit
weak association. The second set of plots show the values simulated on
the scale used in the ratio-of-uniforms algorithm. The association has
been reduced by rotating the parameter axes. The increase in the
proportion of accepted values is only modest in this example (from
approximately 0.26 to 0.30) but this improvement is more substantial in
other examples.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p1</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>  main <span class="op">=</span> <span class="st">"original scale"</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p1</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span>, cex.main <span class="op">=</span> <span class="fl">0.75</span>, cex.lab <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"sampling scale"</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
<p>We produce plots of the estimated marginal posterior densities.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="oxford-temperature-data">Oxford Temperature Data<a class="anchor" aria-label="anchor" href="#oxford-temperature-data"></a>
</h3>
<p>The numeric vector <code>oxford</code> contains 80 annual maximum
temperatures, in degrees Fahrenheit, from 1901 to 1980 at Oxford,
England.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oxford</span><span class="op">)</span></span>
<span><span class="va">prox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"prob"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">88</span>, <span class="fl">95</span><span class="op">)</span>, </span>
<span>                  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2.5</span>, <span class="fl">2.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># revdbayes</span></span>
<span><span class="va">ox_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">prox</span>, data <span class="op">=</span> <span class="va">oxford</span><span class="op">)</span></span></code></pre></div>
<p>We produce plots of the estimated marginal posterior densities.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">ox_post</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">ox_post</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">ox_post</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>We do not illustrate the use of marginal Box-Cox transformation in
the GEV case. If <code>trans = "BC"</code> then we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\phi_1 = \mu</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_2 = [\sigma + \xi (x_{(1)} - \mu) ] / (x_{(m)} - x_{(1)})^{1/2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>3</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_3 = [\sigma + \xi (x_{(m)} - \mu) ] / (x_{(m)} - x_{(1)})^{1/2}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(1)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(m)}</annotation></semantics></math>
are the smallest and largest sample block maxima respectively. This
transformation has been standardised to have Jacobian 1. We apply
Box-Cox transformation only to the (positive) parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\phi_3</annotation></semantics></math>,
because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\phi_1 = \mu</annotation></semantics></math>
is not constrained to be positive and tends to have a marginal posterior
distribution that is not strongly skewed.</p>
</div>
</div>
<div class="section level2">
<h2 id="point-process-pp-model">Point Process (PP) model<a class="anchor" aria-label="anchor" href="#point-process-pp-model"></a>
</h2>
<p>Like the GP model the PP model involves exceedances of a threshold
<code>thresh</code>. However, the PP model has one more parameter than
the GP model, three parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma, \xi)</annotation></semantics></math>
say, because it considers the number of threshold exceedances (that is,
in addition to the sizes of the threshold excesses. The interpretation
of the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma, \xi)</annotation></semantics></math>
is determined by the number of periods of observation, or blocks, into
which the data are grouped. This is set using the argument
<code>noy</code> to <code>rpost</code>. Under the PP model the
distribution of the maximum over each of these blocks has approximately
a GEV distribution with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma, \xi)</annotation></semantics></math>,
provided that the numbers of observations within each block are large.
Although the user may require a posterior sample based on a particular
value of <code>noy</code> it may be that the sampling itself is more
efficient when a different value of <code>noy</code> is used.</p>
<p>We illustrate the use of a prior created by the evdbayes package as
an argument to the revdbayes function <code>rpost</code>. We also show
how the choice of parameterisation of the model affects the strength
posterior dependence between those parameters and hence the efficiency
of simulation from the posterior. <span class="citation">Wadsworth,
Tawn, and Jonathan (2010)</span> note that posterior dependence between
the location parameter and the other two parameters tends to be reduced
if we use a parameterisation in which the number of blocks is equal to
the number of threshold excesses, rather the typical parameterisation
where the number of blocks is equal to the number of years of data. This
is because, in the context of the likelihood alone,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is orthogonal to
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>,</mo><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\sigma, \xi</annotation></semantics></math>)
under this parameterisation. Suppose that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma, \xi)</annotation></semantics></math>
is the parameter vector on the scale of interest, that is, when the
number of blocks is equal to <code>noy</code> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>e</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>e</mi></msub><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu_e, \sigma_e, \xi)</annotation></semantics></math>
is the parameter vector when the number of blocks is set equal to the
number of threshold excesses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>e</mi><mi>x</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">n_{exc}</annotation></semantics></math>.
Then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>e</mi></msub><mo>=</mo><mi>μ</mi><mo>+</mo><mi>σ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>c</mi><mi>ξ</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\mu_e = \mu + \sigma (c ^ \xi - 1) / \xi</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>e</mi></msub><mo>=</mo><mi>σ</mi><msup><mi>c</mi><mi>ξ</mi></msup></mrow><annotation encoding="application/x-tex">\sigma_e = \sigma c ^ \xi</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">c=</annotation></semantics></math><code>noy</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>/</mi><msub><mi>n</mi><mrow><mi>e</mi><mi>x</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">/n_{exc}</annotation></semantics></math>.</p>
<p>The <code>rotate = TRUE</code> argument of <code>rpost</code>
produces a similar effect, but it can reduce posterior dependence
between all parameters. Also, rotating the posterior accounts for the
influence of the prior in the posterior, whereas the argument for
setting <code>noy</code> equal to the number of threshold excesses is
based on the likelihood alone.</p>
<div class="section level3">
<h3 id="rainfall-data">Rainfall Data<a class="anchor" aria-label="anchor" href="#rainfall-data"></a>
</h3>
<p>We illustrate the use of <code>rpost</code> to sample from a
posterior distribution under the PP using the <code>rainfall</code>
dataset, which contains 20820 daily rainfall totals, in mm, recorded at
a rain gauge in England over a 57 year period. Three of these years
contain only missing values so if we wish to parameterise the model in
terms of the GEV parameters of annual maxima we should set
<code>noy = 54</code> when calling <code>rpost</code>. We use the prior
from the evdbayes user’s guide and a threshold of 40mm.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rainfall</span><span class="op">)</span></span>
<span><span class="va">rthresh</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">prrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"quant"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prob <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                    shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38.9</span>, <span class="fl">7.1</span>, <span class="fl">47</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">6.3</span>, <span class="fl">2.6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The first set of plots below relate to the standard parameterisation.
There is posterior dependence between all parameters. The second set of
plots show that rotating the posterior using <code>rotate = TRUE</code>
reduces the dependence.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Annual maximum parameterisation (number of blocks = number of years of data)</span></span>
<span><span class="va">rn0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">prrain</span>, data <span class="op">=</span> <span class="va">rainfall</span>, </span>
<span>  thresh <span class="op">=</span> <span class="va">rthresh</span>, noy <span class="op">=</span> <span class="fl">54</span>, rotate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rn0</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rn0</span><span class="op">$</span><span class="va">pa</span></span>
<span><span class="co">#&gt; [1] 0.1693652</span></span>
<span><span class="co"># Rotation about maximum a posteriori estimate (MAP)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">rn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">prrain</span>, data <span class="op">=</span> <span class="va">rainfall</span>, </span>
<span>  thresh <span class="op">=</span> <span class="va">rthresh</span>, noy <span class="op">=</span> <span class="fl">54</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    2.92    0.08    3.16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rn1</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-17-2.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rn1</span><span class="op">$</span><span class="va">pa</span></span>
<span><span class="co">#&gt; [1] 0.3003995</span></span></code></pre></div>
<p>Using the <span class="citation">Wadsworth, Tawn, and Jonathan
(2010)</span> parameterisation reduces the posterior dependence between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and the other two parameters, but not between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
(see plot on the right labelled with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\rho_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\rho_2</annotation></semantics></math>).
Using the <span class="citation">Wadsworth, Tawn, and Jonathan
(2010)</span> parameterisation and <code>rotate = TRUE</code> also
reduces posterior dependence between all parameters but the earlier plot
suggests that using <code>rotate = TRUE</code> alone is sufficient in
this example.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of blocks = number of threshold excesses</span></span>
<span><span class="va">n_exc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rainfall</span> <span class="op">&gt;</span> <span class="va">rthresh</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">prrain</span>, data <span class="op">=</span> <span class="va">rainfall</span>, </span>
<span>  thresh <span class="op">=</span> <span class="va">rthresh</span>, noy <span class="op">=</span> <span class="fl">54</span>, use_noy <span class="op">=</span> <span class="cn">FALSE</span>, rotate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">rn2</span><span class="op">$</span><span class="va">pa</span></span>
<span><span class="co">#&gt; [1] 0.193039</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rn2</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of blocks = number of threshold excesses, rotation about MAP</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">rn3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">prrain</span>, data <span class="op">=</span> <span class="va">rainfall</span>,</span>
<span>  thresh <span class="op">=</span> <span class="va">rthresh</span>, noy <span class="op">=</span> <span class="fl">54</span>, use_noy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    3.31    0.04    3.55</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rn3</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-18-2.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rn3</span><span class="op">$</span><span class="va">pa</span></span>
<span><span class="co">#&gt; [1] 0.3011232</span></span></code></pre></div>
<p>In this example, rotation of the posterior about its mode using
<code>rotate = TRUE</code> produces the greatest increases in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
and, if this is performed, there is little to choose between the two
choices of the number of blocks. Setting the number of blocks equal to
the number of threshold excesses does reduce posterior dependence
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and the other parameters but enough dependence between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
remains that the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>a</mi></msub><annotation encoding="application/x-tex">p_a</annotation></semantics></math>
doesn’t increase substantially. The reparameterisation resulting from
the rotation is linear in the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma, \xi)</annotation></semantics></math>,
which is simpler than the non-linear transformation from one value of
the number of blocks to another. Using this non-linear transformation in
addition to the rotation has increased the computation time in this
example, that is, <code>rn1</code> takes a little longer to produce than
<code>rn3</code> and this is also the case for other choices of
prior.</p>
<p>We produce plots of the estimated marginal posterior densities.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">rn1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">rn1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">rn1</span><span class="op">$</span><span class="va">sim_vals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, adj <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>We do not illustrate the use of marginal Box-Cox transformation in
the PP case. If <code>trans = "BC"</code> then we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\phi_1 = \mu</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_2 = [\sigma + \xi (u - \mu) ] / (x_{(m)} - u)^{1/2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>3</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_3 = [\sigma + \xi (x_{(m)} - \mu) ] / (x_{(m)} - u)^{1/2}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
is the threshold <code>thresh</code> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(m)}</annotation></semantics></math>
is the largest sample value. As in the GEV case we apply Box-Cox
transformation only to the (positive) parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\phi_3</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-largest-order-statistics-os-model">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>-largest
Order Statistics (OS) model<a class="anchor" aria-label="anchor" href="#r-largest-order-statistics-os-model"></a>
</h2>
<p>The OS model is an extension of the GEV model in which the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
largest sample values (the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
largest order statistics) in each block are modelled, rather than just
the block maximum. More generally, if there are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
blocks then we can use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_i</annotation></semantics></math>
largest order statistics in block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
For the purposes of illustrating how <code>rpost</code> can be used to
sample from a posterior distribution under the OS model we use
<code>venice</code> dataset, which (apart from one year) contains the 10
largest sea levels in Venice for the years 1931-1981. Our analysis is
flawed because, as demonstrated in the evdbayes user guide, it is clear
that a time trend in the location parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
should be considered.</p>
<div class="section level3">
<h3 id="venice-sea-level-data">Venice Sea Level Data<a class="anchor" aria-label="anchor" href="#venice-sea-level-data"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">venice</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span>
<span><span class="va">osv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"os"</span>, prior <span class="op">=</span> <span class="va">pv</span>, data <span class="op">=</span> <span class="va">venice</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">osv</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">osv</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="revdbayes-a-vignette_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p>We do not illustrate the use of marginal Box-Cox transformation in
the OS case. If <code>trans = "BC"</code> then we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">\phi_1 = \mu</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_2 = [\sigma + \xi (x_{(1)} - \mu) ] / (x_{(m)} - x_{(1)})^{1/2}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><mn>3</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>−</mo><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\phi_3 = [\sigma + \xi (x_{(m)} - \mu) ] / (x_{(m)} - x_{(1)})^{1/2}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(1)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msub><annotation encoding="application/x-tex">x_{(m)}</annotation></semantics></math>
are the smallest and largest sample order statistics respectively. Again
we apply Box-Cox transformation only to the (positive) parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϕ</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\phi_3</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-rust" class="csl-entry">
Northrop, P. J. 2017. <em><span class="nocase">r</span>ust:
Ratio-of-Uniforms Simulation with Transformation</em>. <a href="https://CRAN.R-project.org/package=rust" class="external-link">https://CRAN.R-project.org/package=rust</a>.
</div>
<div id="ref-NAJ2016" class="csl-entry">
Northrop, P. J., N. Attalides, and P. Jonathan. 2017.
<span>“Cross-Validatory Extreme Value Threshold Selection and
Uncertainty with Application to Ocean Storm Severity.”</span>
<em>Journal of the Royal Statistical Society: Series C (Applied
Statistics)</em> 66 (1): 93–120. doi:<a href="https://doi.org/10.1111/rssc.12159" class="external-link">10.1111/rssc.12159</a>.
</div>
<div id="ref-Stephenson2016" class="csl-entry">
Stephenson, A. 2016. <span>“Bayesian Inference for Extreme Value
Modelling.”</span> In <em>Extreme Value Modeling and Risk Analysis:
Methods and Applications</em>, edited by D. K. Dey and J. Yan, 257–280.
London: Chapman; Hall. doi:<a href="https://doi.org/10.1201/b19721" class="external-link">10.1201/b19721</a>.
</div>
<div id="ref-evdbayes" class="csl-entry">
Stephenson, A., and M. Ribatet. 2014. <em><span class="nocase">e</span>vdbayes: Bayesian Analysis in Extreme Value
Theory</em>. <a href="https://CRAN.R-project.org/package=evdbayes" class="external-link">https://CRAN.R-project.org/package=evdbayes</a>.
</div>
<div id="ref-WTJ2010" class="csl-entry">
Wadsworth, J. L., J. A. Tawn, and P. Jonathan. 2010. <span>“Accounting
for Choice of Measurement Scale in Extreme Value Modeling.”</span>
<em>The Annals of Applied Statistics</em> 4 (3): 1558–1578. doi:<a href="https://doi.org/10.1214/10-AOAS333" class="external-link">10.1214/10-AOAS333</a>.
</div>
<div id="ref-WGS1991" class="csl-entry">
Wakefield, J. C., A. E. Gelfand, and A. F. M. Smith. 1991.
<span>“Efficient Generation of Random Variates via the Ratio-of-Uniforms
Method.”</span> <em>Statistics and Computing</em> 1 (2): 129–133. doi:<a href="https://doi.org/10.1007/BF01889987" class="external-link">10.1007/BF01889987</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
