<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Posterior Predictive Extreme Value Inference using the revdbayes Package • revdbayes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Posterior Predictive Extreme Value Inference using the revdbayes Package">
<meta property="og:description" content="revdbayes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using the K-gaps model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/revdbayes/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="revdbayes-c-predictive-vignette_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Posterior Predictive Extreme Value Inference using the revdbayes Package</h1>
                        <h4 class="author">Paul J. Northrop</h4>
            
            <h4 class="date">2021-06-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/revdbayes/blob/master/vignettes/revdbayes-c-predictive-vignette.Rmd"><code>vignettes/revdbayes-c-predictive-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>revdbayes-c-predictive-vignette.Rmd</code></div>

    </div>

    
    
<p>This vignette focuses on <em>posterior predictive inference</em> using extreme value models. Posterior predictive inference is the prediction of unobserved variables conditional on observed data, performed by integrating parameter-specific inferences over a posterior distribution for model parameters. In practice, the integration averaging is performed using an empirical average based on samples from the posterior distribution. The vignette <a href="revdbayes-a-vignette.html">Introducing revdbayes</a> covers the sampling from extreme value posterior distributions and the vignette <a href="revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a> considers how to do this more quickly.</p>
<p>We consider two uses of posterior predictive inference. In the first we simulate from the posterior predictive distribution many replicates of the observed data. A comparison of these replicates to the observed data provides a way to assess the fit of the model: systematic differences in behaviour between the observed and replicated data suggest features of the data that are not represented well by the model. For greater detail see Chapter 6 of <span class="citation">Gelman et al. (2014)</span>. Secondly, we define as the variable of interest the largest value <span class="math inline">\(M_N\)</span> to be observed over a future time period of length <span class="math inline">\(N\)</span> years and estimate under the extreme value model the conditional distribution of <span class="math inline">\(M_N\)</span> given the observed data. This accounts for uncertainty in model parameters and for uncertainty owing to the variability of future observations.</p>
<p>We illustrate the code used to perform these two tasks using the <code>portpirie</code> and <code>gom</code> datasets that feature in the vignette <a href="revdbayes-a-vignette.html">Introducing revdbayes</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set the number of posterior samples required.</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/">revdbayes</a></span><span class="op">)</span></code></pre></div>
<p>We produce posterior samples for later use. The argument <code>nrep = 50</code> to <code>rpost</code> results in 50 simulated replicates of the data being returned in <code>object$data_rep</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### GEV model for Port Pirie Annual Maximum Sea Levels </span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">portpirie</span><span class="op">)</span>
<span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="va">pn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span>
<span class="va">gevp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pn</span>, data <span class="op">=</span> <span class="va">portpirie</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>

<span class="co">### GP model for Gulf-of-Mexico significant wave heights</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">gom</span><span class="op">)</span>
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span>
<span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">gpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>, data <span class="op">=</span> <span class="va">gom</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div id="posterior-predictive-model-checking" class="section level2">
<h2 class="hasAnchor">
<a href="#posterior-predictive-model-checking" class="anchor"></a>Posterior predictive model checking</h2>
<p>The <code>pp_check</code> method <code>pp_check.evpost</code> provides an interface to the posterior predictive checking graphics available in the <em>bayesplot</em> package <span class="citation">(Gabry and Mahr 2017)</span>. For details see the bayesplot vignette <a href="https://CRAN.R-project.org/package=bayesplot">Graphical posterior predictive checks</a>. <em>bayesplot</em> functions return a <code>ggplot</code> object that can be customised using the <em>gglot2</em> package <span class="citation">(Wickham 2009)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/">bayesplot</a></span><span class="op">)</span>
<span class="co">#&gt; This is bayesplot version 1.8.0</span>
<span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/bayesplot</span>
<span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span>
<span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span>
<span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>We show three examples of the graphical posterior predictive checks that are available from <em>bayesplot</em>.</p>
<div id="overlaid-density-and-distribution-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#overlaid-density-and-distribution-functions" class="anchor"></a>Overlaid density and distribution functions</h3>
<p>Calling <code>pp_check</code> with <code>type = "overlaid"</code> produces plots in which either the empirical distribution functions or kernel density estimates of the observed and replicated data are compared. If the model fits well then the observed data should look like a typical replication from the posterior predictive distribution, which seems to be the case here.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GEV</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"overlaid"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"GEV empirical distribution functions"</span><span class="op">)</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"overlaid"</span>, subtype <span class="op">=</span> <span class="st">"dens"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"GEV kernel density estimates"</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-5-1.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-5-2.png" width="50%"></p>
</div>
<div id="multiple-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-plots" class="anchor"></a>Multiple plots</h3>
<p>Using <code>type = multiple</code> produces multiple plots, rather than overlaid plots, with <code>subtype</code> indicating the type of plots to be drawn. By default only 8 plots of replicated data are drawn, but this can be changed using the <code>nrep</code> argument. Again, the plot of the observed data is not obviously different from those of the replicated data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span>, type <span class="op">=</span> <span class="st">"multiple"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"GP kernel density estimates"</span><span class="op">)</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span>, type <span class="op">=</span> <span class="st">"multiple"</span>, subtype <span class="op">=</span> <span class="st">"boxplot"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"GP boxplots"</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-6-1.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-6-2.png" width="50%"></p>
</div>
<div id="posterior-predictive-test-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-predictive-test-statistics" class="anchor"></a>Posterior predictive test statistics</h3>
<p>The default setting for <code>pp_check</code> is to produce a plot that compares the values of test statistics for the observed and replicated data. The argument <code>stat</code> defines the test statistic (or a pair of test statistics) to use, using either the name of a standard function or a user-defined function. For a model that fits well the value of the statistic calculated from the observed data should not be unusual compared to the values calculated from the replicated data. In this example, the plots do not suggest clear lack-of-fit.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span>, stat <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span>, stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span><span class="op">)</span>
<span class="va">iqr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/pp_check.evpost.html">pp_check</a></span><span class="op">(</span><span class="va">gpg</span>, stat <span class="op">=</span> <span class="st">"iqr"</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-7-1.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-7-2.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-7-3.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-7-4.png" width="50%"></p>
</div>
</div>
<div id="posterior-predictive-extreme-value-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#posterior-predictive-extreme-value-inference" class="anchor"></a>Posterior predictive extreme value inference</h2>
<p>Posterior predictive inferences for the largest value <span class="math inline">\(M_N\)</span> to be observed over a future time period of length <span class="math inline">\(N\)</span> years is performed by the <code>predict</code> method for the objects of class <code>evpost</code> returned from <code>rpost</code>. Objects returned from <code>predict.evpost</code> have class <code>evpred</code>. The <code>plot</code> method for these objects produces graphical summaries of the output from <code>predict</code>.</p>
<p>To perform predictive inference about <span class="math inline">\(M_N\)</span> we need to provide, or assume, information about the timescale covered by the data. To do this we need to supply the mean number <code>npy</code> of non-missing observations per year, either in the call to <code>rpost</code> or the call to <code>predict</code>. For the GEV and OS models it is often the case that the input data are annual maxima, so <code>npy = 1</code> is the default value if <code>npy</code> is not supplied. For the PP model a similar assumption is made: see the documentation for <code>predict.evpost</code> for details. For the binomial-GP model (note that we need the binomial part in order to account for the rate at which the threshold is exceedance) <code>npy</code> must be provided by the user.</p>
<p>Let <span class="math inline">\(F_{M_N}(z; \theta)\)</span> denote the distribution function of <span class="math inline">\(M_N\)</span> conditional on the parameters <span class="math inline">\(\theta\)</span> of an extreme value model and let <span class="math inline">\(\pi(\theta \mid x)\)</span> be the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed data. Then, if we assume that given <span class="math inline">\(\theta\)</span> future observations are independent of the data <span class="math inline">\(x\)</span> then posterior predictive distribution function of <span class="math inline">\(M_N\)</span> given only the data <span class="math inline">\(x\)</span> is given by <span class="math display">\[ P(M_N \leqslant z \mid x) = \int F_{M_N}(z; \theta) \, \pi(\theta \mid x) {\rm ~d}\theta. \]</span> We estimate <span class="math inline">\(P(M_N \leqslant z)\)</span> using <span class="math display">\[ \hat{P}(M_N \leqslant z \mid x) = \frac1m \sum_{j=1}^m F_{M_N}(z; \theta_j), \]</span> where <span class="math inline">\(\theta_j, j=1, \ldots, m\)</span> is a sample from the posterior distribution <span class="math inline">\(\pi(\theta \mid x)\)</span>.</p>
<p>The form of <span class="math inline">\(F_{M_N}(z; \theta)\)</span> depends on the extreme value model. The GEV, OS and PP models are each parameterised by the location, scale and shape parameters of a GEV distribution. Let <span class="math inline">\(G(z; \theta)\)</span> be the GEV distribution function for an annual maximum under a given such model, after appropriate adjustment for the value of <code>npy</code>. Then, <span class="math inline">\(F_{M_N}(z; \theta) = G(z; \theta)^{N}\)</span>. For the binomial-GP model, provided that <span class="math inline">\(z\)</span> is the greater than the threshold <span class="math inline">\(u\)</span>, <span class="math inline">\(F_{M_N}(z; \theta) = F(z; \theta)^{n_{py} N}\)</span>, where <span class="math inline">\(n_{py}\)</span> is the value of <code>npy</code> and <span class="math display">\[ F(z; \theta) = 1-p_u \left\{1+\xi\left(\frac{z-u}{\sigma_u}\right)\right\}^{-1/\xi}. \]</span> See <span class="citation">Northrop, Attalides, and Jonathan (2017)</span> for greater detail.</p>
<p>We repeat the posterior simulation for the Gulf-of-Mexico example, changing <code>model = gp</code> to <code>model = bingp</code> in the call to <code>rpost</code> to add inferences about the probability of threshold exceedance based on a binomial distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Binomial-GP model for Gulf-of-Mexico significant wave heights</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">gom</span><span class="op">)</span>
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span>
<span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_bin_prior.html">set_bin_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"jeffreys"</span><span class="op">)</span>
<span class="co"># We need to provide the mean number of observations per year (the data cover a period of 105 years)</span>
<span class="va">npy_gom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gom</span><span class="op">)</span><span class="op">/</span><span class="fl">105</span>
<span class="va">bgpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rpost.html">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"bingp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>, data <span class="op">=</span> <span class="va">gom</span>,
              bin_prior <span class="op">=</span> <span class="va">bp</span>, npy <span class="op">=</span> <span class="va">npy_gom</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div id="posterior-predictive-density-and-distribution-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-predictive-density-and-distribution-functions" class="anchor"></a>Posterior predictive density and distribution functions</h3>
<p>We plot, for the analyses of the <code>portpirie</code> (GEV) and <code>gom</code> (binomial-GP) datasets, the estimated posterior predictive density functions and distributions functions of <span class="math inline">\(M_N\)</span> for <span class="math inline">\(N = 100\)</span> and <span class="math inline">\(N = 1000\)</span>. The argument <code>n_years</code> gives the value(s) of <span class="math inline">\(N\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># GEV (Portpirie)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"d"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"p"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-9-1.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-9-2.png" width="50%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># binGP (Gulf-of-Mexico)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"d"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"p"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-10-1.png" width="50%"><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-10-2.png" width="50%"></p>
<p>As one would expect there is greater uncertainty for <span class="math inline">\(N=1000\)</span> than for <span class="math inline">\(N=100\)</span>. In making inferences over a period of length 1000 years a large degree of uncertainty is to be expected. For the Gulf-of-Mexico data in particular, this results in appreciable probability on values of significant wave height thought by experts to be physically unrealistic.</p>
</div>
<div id="posterior-predictive-intervals" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-predictive-intervals" class="anchor"></a>Posterior predictive intervals</h3>
<p>The default setting for <code>predict.evpost</code> is to estimate posterior predictive intervals for <span class="math inline">\(M_N\)</span>. In addition to <code>n_years</code> we can specify the probability level <code>level</code> of the interval(s), that is, the estimated probability that <span class="math inline">\(M_N\)</span> lies within the interval. Two types of interval can be calculated. One is an equi-tailed interval in which the estimated probability that <span class="math inline">\(M_N\)</span> lies below the lower limit of the interval is equal to the estimated probability that <span class="math inline">\(M_N\)</span> lies above the upper limit of the interval. Typically, there will exist intervals of the required probability level that is shorter than the equi-tailed interval. <code>predict.evpost</code> can search for the shortest such interval. If the estimated posterior predictive distribution is unimodal then this interval is the <em>highest predictive density</em> (HPD) interval, with the property that at all values inside the interval the estimated posterior predictive density is greater than at all values outside the interval. If <code>hpd = FALSE</code> then only equi-tailed intervals are returned. If <code>hpd = TRUE</code> then both types of interval are returned.</p>
<p>The <code>plot.evpred</code> method plots the estimated posterior predictive intervals for each value in <code>n_years</code> and each level in <code>level</code>. The argument <code>which_int</code> controls which of the two types of interval are included. The dashed lines give the HPD intervals and the solid lines the equi-tailed intervals. Each line is labelled by the level of the interval.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i_gevp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gevp</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">99</span><span class="op">)</span>, hpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">i_gevp</span>, which_int <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i_bgpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">99</span><span class="op">)</span>, hpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">i_bgpp</span>, which_int <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></code></pre></div>
<p><img src="revdbayes-c-predictive-vignette_files/figure-html/unnamed-chunk-11-2.png" width="672"></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bayesplot" class="csl-entry">
Gabry, Jonah, and Tristan Mahr. 2017. <em>Bayesplot: Plotting for Bayesian Models</em>. <a href="https://CRAN.R-project.org/package=bayesplot">https://CRAN.R-project.org/package=bayesplot</a>.
</div>
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, Dunson Stern H. S., and D. B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. London: Chapman &amp; Hall / CRC Press. <a href="http://www.stat.columbia.edu/~gelman/book/">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-NAJ2016" class="csl-entry">
Northrop, P. J., N. Attalides, and P. Jonathan. 2017. <span>“Cross-Validatory Extreme Value Threshold Selection and Uncertainty with Application to Ocean Storm Severity.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 66 (1): 93–120. <a href="https://doi.org/10.1111/rssc.12159">https://doi.org/10.1111/rssc.12159</a>.
</div>
<div id="ref-ggplot2" class="csl-entry">
Wickham, Hadley. 2009. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
