<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prior simulation of GEV parameters - prior on probability scale — rprior_prob • revdbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prior simulation of GEV parameters - prior on probability scale — rprior_prob"><meta property="og:description" content="Simulates from the prior distribution for GEV parameters based on
Crowder (1992), in which independent beta priors are specified
for ratios of probabilities (which is equivalent to
a Dirichlet prior on differences between these probabilities)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/EVA2021revdbayes.html">EVA 2021 R Workshop: revdbayes</a>
    </li>
    <li>
      <a href="../articles/ex1revdbayes.html">EVA 2021 revdbayes exercises 1</a>
    </li>
    <li>
      <a href="../articles/ex2revdbayes.html">EVA 2021 revdbayes exercises 2</a>
    </li>
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using the K-gaps model</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/revdbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prior simulation of GEV parameters - prior on probability scale</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/revdbayes/blob/HEAD/R/rprior.R" class="external-link"><code>R/rprior.R</code></a></small>
    <div class="hidden name"><code>rprior_prob.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates from the prior distribution for GEV parameters based on
Crowder (1992), in which independent beta priors are specified
for ratios of probabilities (which is equivalent to
a Dirichlet prior on differences between these probabilities).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">rprior_prob</span><span class="op">(</span><span class="va">n</span>, <span class="va">quant</span>, <span class="va">alpha</span>, exc <span class="op">=</span> <span class="cn">FALSE</span>, lb <span class="op">=</span> <span class="cn">NULL</span>, lb_prob <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>A numeric scalar. The size of sample required.</p></dd>
<dt>quant</dt>
<dd><p>A numeric vector of length 3.  Contains quantiles
\(q_1, q_2, q_3\).  A prior distribution is placed on the
non-exceedance (<code>exc = FALSE</code>) or exceedance (<code>exc = TRUE</code>)
probabilities corresponding to these quantiles.
The values should <em>increase</em> with the index of the vector.
If not, the values in <code>quant</code> will be sorted into increasing order
without warning.</p></dd>
<dt>alpha</dt>
<dd><p>A numeric vector of length 4. Parameters of the Dirichlet
distribution for the exceedance probabilities.</p></dd>
<dt>exc</dt>
<dd><p>A logical scalar.  Let \(M\) be the GEV variable,
\(r_q = P(M \leq q)\),
\(p_q = P(M &gt; q) = 1 - r_q\) and
<code>quant</code> = (\(q_1, q_2, q_3\)).
If <code>exc = FALSE</code> then a Dirichlet(<code>alpha</code>) distribution is
placed on
\((r_{q_1}, r_{q_2} - r_{q_1}, r_{q_3} - r_{q_2}, 1 - r_{q_3})\), as in
Northrop et al. (2017).
If <code>exc = TRUE</code> then a Dirichlet(<code>alpha</code>) distribution
is placed on
\((1 - p_{q_1}, p_{q_1} - p_{q_2}, p_{q_2} - p_{q_3}, p_{q_3})\), where
\(p_q = P(M &gt; q)\), as in Stephenson (2016).</p></dd>
<dt>lb</dt>
<dd><p>A numeric scalar.  If this is not <code>NULL</code> then the simulation
is constrained so that <code>lb</code> is an approximate lower bound on the
GEV variable.  Specifically, only simulated GEV parameter values for
which the 100<code>lb_prob</code>% quantile is greater than <code>lb</code> are
retained.</p></dd>
<dt>lb_prob</dt>
<dd><p>A numeric scalar.  The non-exceedance probability involved
in the specification of <code>lb</code>.  Must be in (0,1).  If <code>lb=NULL</code>
then <code>lb_prob</code> is not used.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An <code>n</code> by 3 numeric matrix.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The simulation is based on the way that the prior is constructed.
  See Stephenson (1996) the evdbayes user guide or Northrop et al. (2017)
  Northrop et al. (2017) for details of the construction of the prior.
  First, differences between probabilities are simulated from a Dirichlet
  distribution. Then the GEV location, scale and shape parameters that
  correspond to these quantile values are found, by solving numerically a
  set of three non-linear equations in which the GEV quantile function
  evaluated at the simulated probabilities is equated to the quantiles in
  <code>quant</code>. This is reduced to a one-dimensional optimisation over the
  GEV shape parameter.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Crowder, M. (1992) Bayesian priors based on parameter
  transformation using the distribution function.
  <em>Ann. Inst. Statist. Math.</em>, <strong>44</strong>(3), 405-416.
  <a href="https://link.springer.com/article/10.1007/BF00050695" class="external-link">https://link.springer.com/article/10.1007/BF00050695</a></p>
<p>Stephenson, A. 2016. Bayesian Inference for Extreme Value
  Modelling. In <em>Extreme Value Modeling and Risk Analysis: Methods and
  Applications</em>, edited by D. K. Dey and J. Yan, 257-80. London:
  Chapman and Hall. doi: <a href="https://doi.org/10.1201/b19721" class="external-link">10.1201/b19721</a></p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
  Cross-validatory extreme value threshold selection and uncertainty
  with application to ocean storm severity.
  <em>Journal of the Royal Statistical Society Series C: Applied
  Statistics</em>, <strong>66</strong>(1), 93-120.
  doi: <a href="https://doi.org/10.1111/rssc.12159" class="external-link">10.1111/rssc.12159</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rpost.html">rpost</a></code> and <code><a href="rpost_rcpp.html">rpost_rcpp</a></code> for sampling
  from an extreme value posterior distribution.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">quant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">88</span>, <span class="fl">95</span><span class="op">)</span></span>
<span class="r-in"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2.5</span>, <span class="fl">2.25</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rprior_prob</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, quant <span class="op">=</span> <span class="va">quant</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, exc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rprior_prob</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, quant <span class="op">=</span> <span class="va">quant</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, exc <span class="op">=</span> <span class="cn">TRUE</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

