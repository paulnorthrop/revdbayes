<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predictive inference for the largest value observed in \(N\) years. — predict.evpost • revdbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predictive inference for the largest value observed in \(N\) years. — predict.evpost"><meta property="og:description" content='predict method for class "evpost".  Performs predictive inference
about the largest value to be observed over a future time period of
\(N\) years.  Predictive inferences accounts for uncertainty in model
parameters and for uncertainty owing to the variability of future
observations.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/EVA2021revdbayes.html">EVA 2021 R Workshop: revdbayes</a>
    </li>
    <li>
      <a href="../articles/ex1revdbayes.html">EVA 2021 revdbayes exercises 1</a>
    </li>
    <li>
      <a href="../articles/ex2revdbayes.html">EVA 2021 revdbayes exercises 2</a>
    </li>
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using threshold interexceedance times</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/revdbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predictive inference for the largest value observed in \(N\) years.</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/revdbayes/blob/HEAD/R/predictive.R" class="external-link"><code>R/predictive.R</code></a></small>
    <div class="hidden name"><code>predict.evpost.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>predict</code> method for class "evpost".  Performs predictive inference
about the largest value to be observed over a future time period of
\(N\) years.  Predictive inferences accounts for uncertainty in model
parameters and for uncertainty owing to the variability of future
observations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for evpost</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"p"</span>, <span class="st">"d"</span>, <span class="st">"q"</span>, <span class="st">"r"</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_num <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_years <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  npy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">95</span>,</span>
<span>  hpd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lower_tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  big_q <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>"evpost"</code>, a result of a call to
  <code><a href="rpost.html">rpost</a></code> or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code> with <code>model = "gev"</code>,
  <code>model = "os"</code>, <code>model = "pp"</code> or <code>model == "bingp"</code>.
  Calling these functions after a call to <code>rpost</code> or <code>rpost_rcpp</code>
  with <code>model == "gp"</code> will produce an error, because inferences about
  the probability of threshold exceedance are required, in addition to the
  distribution of threshold excesses. The model is stored in
  <code>object$model</code>.</p>
<p><code>object</code> may also be an object created within the function
  <code>predict.blite</code> in the <code>lite</code> package. In this case
  <code>object$sim_vals</code> has a column named <code>"theta"</code> containing
  a posterior sample of values of the extremal index.</p></dd>


<dt>type</dt>
<dd><p>A character vector.  Indicates which type of inference is
  required:</p><ul><li><p>"i" for predictive intervals,</p></li>
<li><p>"p" for the predictive distribution function,</p></li>
<li><p>"d" for the predictive density function,</p></li>
<li><p>"q" for the predictive quantile function,</p></li>
<li><p>"r" for random generation from the predictive distribution.</p></li>
</ul></dd>


<dt>x</dt>
<dd><p>A numeric vector or a matrix with <code>n_years</code> columns.
  The meaning of <code>x</code> depends on <code>type</code>.</p><ul><li><p><code>type = "p"</code> or <code>type = "d"</code>: <code>x</code> contains
      quantiles at which to evaluate the distribution or density function.</p>
<p>If <code>object$model == "bingp"</code> then no element of <code>x</code> can be
      less than the threshold <code>object$thresh</code>.</p>
<p>If <code>x</code> is not supplied then <code>n_year</code>-specific defaults are
      set: vectors of length <code>x_num</code> from the 0.1% quantile to the
      99% quantile, subject all values being greater than the threshold.</p></li>
<li><p><code>type = "q"</code>: <code>x</code> contains probabilities in (0,1)
      at which to evaluate the quantile function.  Any values outside
      (0, 1) will be removed without warning.</p>
<p>If <code>object$model == "bingp"</code> then no element of <code>p</code> can
      correspond to a predictive quantile that is below the threshold,
      <code>object$thresh</code>.  That is, no element of <code>p</code> can be less
      than the value of <code>predict.evpost(object,</code>
      <code>type = "q", x = object$thresh)</code>.</p>
<p>If <code>x</code> is not supplied then a default value of
      <code>c(0.025, 0.25, 0.5, 0.75, 0.975)</code> is used.</p></li>
<li><p><code>type = "i"</code> or <code>type = "r"</code>: <code>x</code> is not relevant.</p></li>
</ul></dd>


<dt>x_num</dt>
<dd><p>A numeric scalar.  If <code>type = "p"</code> or <code>type = "d"</code>
and <code>x</code> is not supplied then <code>x_num</code> gives the number of values
in <code>x</code> for each value in <code>n_years</code>.</p></dd>


<dt>n_years</dt>
<dd><p>A numeric vector. Values of \(N\).</p></dd>


<dt>npy</dt>
<dd><p>A numeric scalar. The mean number of observations per year
  of data, after excluding any missing values, i.e. the number of
  non-missing observations divided by total number of years' worth of
  non-missing data.</p>
<p>If <code>rpost</code> or <code>rpost_rcpp</code> was called with
<code>model == "bingp"</code> then <code>npy</code> must either have been supplied
in that call or be supplied here.</p>
<p>Otherwise, a default value will be assumed if <code>npy</code> is not supplied,
based on the value of <code>model</code> in the call to <code>rpost</code> or
<code>rpost_rcpp</code>:</p><ul><li><p><code>model = "gev"</code>: <code>npy</code> = 1, i.e. the data were
    annual maxima so the block size is one year.</p></li>
<li><p><code>model = "os"</code>: <code>npy</code> = 1, i.e. the data were
    annual order statistics so the block size is one year.</p></li>
<li><p><code>model = "pp"</code>:
    <code>npy</code> = <code>length(x$data)</code> / <code>object$noy</code>,
    i.e. the value of <code>noy</code> used in the call to <code><a href="rpost.html">rpost</a></code>
    or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code> is equated to a block size of one year.</p></li>
</ul><p>If <code>npy</code> is supplied twice then the value supplied here will be
used and a warning given.</p></dd>


<dt>level</dt>
<dd><p>A numeric vector of values in (0, 100).
Only relevant when <code>type = "i"</code>.
Levels of predictive intervals for the largest value observed in
\(N\) years, i.e. level% predictive intervals are returned.</p></dd>


<dt>hpd</dt>
<dd><p>A logical scalar.
  Only relevant when <code>type = "i"</code>.</p>
<p>If <code>hpd = FALSE</code> then the interval is
  equi-tailed, with its limits produced by <br><code>predict.evpost(</code><code>object, type ="q", x = p)</code>,
  where <code>p = c((1-level/100)/2,</code> <code>(1+level/100)/2)</code>.</p>
<p>If <code>hpd = TRUE</code> then, in addition to the equi-tailed interval,
  the shortest possible level% interval is calculated.
  If the predictive distribution is unimodal then this
  is a highest predictive density (HPD) interval.</p></dd>


<dt>lower_tail</dt>
<dd><p>A logical scalar.
Only relevant when <code>type = "p"</code> or <code>type = "q"</code>.
If TRUE (default), (output or input) probabilities are
\(P[X \leq x]\), otherwise, \(P[X &gt; x]\).</p></dd>


<dt>log</dt>
<dd><p>A logical scalar.  Only relevant when <code>type = "d"</code>.
If TRUE the log-density is returned.</p></dd>


<dt>big_q</dt>
<dd><p>A numeric scalar.  Only relevant when <code>type = "q"</code>.
An initial upper bound for the desired quantiles to be passed to
<code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> (its argument <code>upper</code>) in the
search for the predictive quantiles.  If this is not sufficiently large
then it is increased until it does provide an upper bound.</p></dd>


<dt>...</dt>
<dd><p>Additional optional arguments. At present no optional
arguments are used.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class "evpred", a list containing a subset of the
  following components:</p>
<dl><dt>type</dt>
<dd><p>The argument <code>type</code> supplied to <code>predict.evpost</code>.
    Which of the following components are present depends <code>type</code>.</p></dd>

    <dt>x</dt>
<dd><p>A matrix containing the argument <code>x</code> supplied to
      <code>predict.evpost</code>, or set within <code>predict.evpost</code> if <code>x</code>
      was not supplied, replicated to have <code>n_years</code> columns
      if necessary.
      Only present if <code>type</code> is <code>"p", "d"</code> or <code>"q"</code>.</p></dd>

    <dt>y</dt>
<dd><p>The content of <code>y</code> depends on <code>type</code>:</p><ul><li><p><code>type = "p", "d", "q"</code>:  A matrix with the same
      dimensions as <code>x</code>.  Contains distribution function values
      (<code>type = "p"</code>), predictive density (<code>type = "d"</code>)
      or quantiles (<code>type = "q"</code>).</p></li>
<li><p><code>type = "r"</code>: A numeric matrix with <code>length(n_years)</code>
      columns and number of rows equal to the size of the posterior sample.</p></li>
<li><p><code>type = "i"</code>: <code>y</code> is not present.</p></li>
</ul></dd>

      <dt>long</dt>
<dd><p>A <code>length(n_years)*length(level)</code> by 4 numeric
        matrix containing the equi-tailed limits with columns:
        lower limit, upper limit, n_years, level.
        Only present if <code>type = "i"</code>.  If an interval extends below
        the threshold then <code>NA</code> is returned.</p></dd>

      <dt>short</dt>
<dd><p>A matrix with the same structure as <code>long</code>
        containing the HPD limits.  Only present if <code>type = "i"</code>.
        Columns 1 and 2 contain <code>NA</code>s if <code>hpd = FALSE</code>
        or if the corresponding equi-tailed interval extends below
        the threshold.</p></dd>

</dl><p>The arguments <code>n_years, level, hpd, lower_tail, log</code> supplied
  to <code>predict.evpost</code> are also included, as is the argument <code>npy</code></p>


<p>supplied to, or set within, <code>predict.evpost</code> and
  the arguments <code>data</code> and <code>model</code> from the original call to</p>
<p></p>
<p><code><a href="rpost.html">rpost</a></code> or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Inferences about future extreme observations are integrated over
  the posterior distribution of the model parameters, thereby accounting
  for uncertainty in model parameters and uncertainty owing to the
  variability of future observations.  In practice the integrals involved
  are estimated using an empirical mean over the posterior sample.
  See, for example, Coles (2001), Stephenson (2016) or
  Northrop et al. (2017) for details. See also the vignette
  <a href="https://CRAN.R-project.org/package=revdbayes" class="external-link">Posterior Predictive Extreme Value Inference</a></p>
<p><strong>GEV / OS / PP</strong>.
  If <code>model = "gev"</code>, <code>model = "os"</code> or <code>model = "pp"</code>
  in the call to <code><a href="rpost.html">rpost</a></code> or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code>
  we first calculate the number of blocks \(b\) in <code>n_years</code> years.
  To calculate the density function or distribution function of the maximum
  over <code>n_years</code> we call <code><a href="gev.html">dgev</a></code> or <code><a href="gev.html">pgev</a></code>
  with <code>m</code> = \(b\).</p>
<p></p><ul><li><p><code>type = "p"</code>. We calculate using <code><a href="gev.html">pgev</a></code>
    the GEV distribution function at <code>q</code> for each of the posterior
    samples of the location, scale and shape parameters.  Then we take
    the mean of these values.</p></li>
<li><p><code>type = "d"</code>. We calculate using <code><a href="gev.html">dgev</a></code>
    the GEV density function at <code>x</code> for each of the posterior samples
    of the location, scale and shape parameters.  Then we take the
    mean of these values.</p></li>
<li><p><code>type = "q"</code>. We solve numerically
    <code>predict.evpost(object, type = "p", x = q)</code> = <code>p[i]</code>
    numerically for <code>q</code> for each element <code>p[i]</code> of <code>p</code>.</p></li>
<li><p><code>type = "i"</code>. If <code>hpd = FALSE</code> then the interval is
    equi-tailed, equal to <code>predict.evpost()</code> <code>object, type ="q", x = p)</code>,
    where <code>p = c((1-level/100)/2,</code> <code>(1+level/100)/2)</code>.
    If <code>hpd = TRUE</code> then, in addition, we perform a
    numerical minimisation of the length of level% intervals, after
    approximating the predictive quantile function using monotonic
    cubic splines, to reduce computing time.</p></li>
<li><p><code>type = "r"</code>. For each simulated value of the GEV parameters
    at the <code>n_years</code> level of aggregation we simulate one value from
    this GEV distribution using <code><a href="gev.html">rgev</a></code>.  Thus, each sample
    from the predictive distribution is of a size equal to the size of
    the posterior sample.</p></li>
</ul><p><strong>Binomial-GP</strong>.  If <code>model = "bingp"</code> in the call to
  <code><a href="rpost.html">rpost</a></code> or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code> then we calculate the
  mean number of observations in <code>n_years</code> years, i.e.
  <code>npy * n_years</code>.</p>
<p>Following Northrop et al. (2017), let \(M_N\) be the largest value
  observed in \(N\) years, \(m\) = <code>npy * n_years</code> and \(u\) the
  threshold <code>object$thresh</code> used in the call to <code>rpost</code>
  or <code>rpost_rcpp</code>.
  For fixed values of \(\theta = (p, \sigma, \xi)\) the distribution
  function of \(M_N\) is given by \(F(z, \theta)^m\), for
  \(z \geq u\), where
  $$F(z, \theta) = 1 - p [1 + \xi (x - u) / \sigma] ^ {-1/\xi}.$$
  The distribution function of \(M_N\) cannot be evaluated for
  \(z &lt; u\) because no model has been supposed for observations below
  the threshold.</p>
<ul><li><p><code>type = "p"</code>. We calculate
    \(F(z, \theta)^m\) at <code>q</code> for each of the posterior samples
    \(\theta\).  Then we take the mean of these values.</p></li>
<li><p><code>type = "d"</code>.  We calculate the density of of \(M_n\), i.e.
    the derivative of \(F(z, \theta)^m\) with respect to \(z\) at
    <code>x</code> for each of the posterior samples \(\theta\).  Then we take
    the mean of these values.</p></li>
<li><p><code>type = "q"</code> and <code>type = "i"</code>. We perform calculations
    that are analogous to the GEV case above.  If <code>n_years</code> is very
    small and/or level is very close to 100 then a predictive interval
    may extend below the threshold.  In such cases <code>NA</code>s are returned
    (see <strong>Value</strong> below).</p></li>
<li><p><code>type = "r"</code>.  For each simulated value of the bin-GP
    parameter we simulate from the distribution of \(M_N\) using the
    inversion method applied to the distribution function of \(M_N\) given
    above.  Occasionally a value below the threshold would need to be
    simulated.  If these instances a missing value code <code>NA</code> is
    returned. Thus, each sample from the predictive distribution is of a
    size equal to the size of the posterior sample, perhaps with a small
    number os <code>NA</code>s.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  Chapter 9: <a href="https://doi.org/10.1007/978-1-4471-3675-0_9" class="external-link">doi:10.1007/978-1-4471-3675-0_9</a></p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
  Cross-validatory extreme value threshold selection and uncertainty
  with application to ocean storm severity.
  <em>Journal of the Royal Statistical Society Series C: Applied
  Statistics</em>, <strong>66</strong>(1), 93-120.
  <a href="https://doi.org/10.1111/rssc.12159" class="external-link">doi:10.1111/rssc.12159</a></p>
<p>Stephenson, A. (2016). Bayesian Inference for Extreme Value
  Modelling. In <em>Extreme Value Modeling and Risk Analysis: Methods and
  Applications</em>, edited by D. K. Dey and J. Yan, 257-80. London:
  Chapman and Hall. <a href="https://doi.org/10.1201/b19721" class="external-link">doi:10.1201/b19721</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.evpred.html">plot.evpred</a></code> for the S3 <code>plot</code> method for
  objects of class <code>evpred</code>.</p>
<p><code><a href="rpost.html">rpost</a></code> or <code><a href="rpost_rcpp.html">rpost_rcpp</a></code> for sampling
  from an extreme value posterior distribution.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### GEV</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">portpirie</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pn</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gevp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="rpost_rcpp.html">rpost_rcpp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pn</span>, data <span class="op">=</span> <span class="va">portpirie</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interval estimation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span><span class="op">)</span><span class="op">$</span><span class="va">long</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lower    upper n_years level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.451273 5.965358     100    95</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, hpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">short</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lower    upper n_years level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.370482 5.663344     100    95</span>
<span class="r-in"><span><span class="co"># Density function</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">:</span><span class="fl">7</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"d"</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.055812e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 8.058518e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 4.428353e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 6.369456e-03</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"d"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Distribution function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"p"</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.875524e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 7.355106e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 9.765978e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 9.951038e-01</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"p"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Quantiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"q"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.451273 4.681728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 4.640359 4.933184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 4.792013 5.169029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 5.018543 5.550780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 5.965358 7.319849</span>
<span class="r-in"><span><span class="co"># Random generation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gevp</span>, type <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Binomial-GP</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_bin_prior.html">set_bin_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"jeffreys"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">npy_gom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gom</span><span class="op">)</span><span class="op">/</span><span class="fl">105</span></span></span>
<span class="r-in"><span><span class="va">bgpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="rpost_rcpp.html">rpost_rcpp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"bingp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">gom</span>, bin_prior <span class="op">=</span> <span class="va">bp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting npy in call to predict.evpost()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, npy <span class="op">=</span> <span class="va">npy_gom</span><span class="op">)</span><span class="op">$</span><span class="va">long</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lower    upper n_years level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 10.4411 42.51709     100    95</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting npy in call to rpost() or rpost_rcpp()</span></span></span>
<span class="r-in"><span><span class="va">bgpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="rpost_rcpp.html">rpost_rcpp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"bingp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span></span>
<span class="r-in"><span>                   data <span class="op">=</span> <span class="va">gom</span>, bin_prior <span class="op">=</span> <span class="va">bp</span>, npy <span class="op">=</span> <span class="va">npy_gom</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interval estimation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span><span class="op">)</span><span class="op">$</span><span class="va">long</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lower    upper n_years level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 10.36809 41.21436     100    95</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, hpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">short</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         lower    upper n_years level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 8.985649 33.23781     100    95</span>
<span class="r-in"><span><span class="co"># Density function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"d"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Distribution function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"p"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Quantiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"q"</span>, n_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 10.36809 14.85598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 13.28051 19.77113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 15.84112 24.67150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 19.96799 33.47908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 41.21436 86.01371</span>
<span class="r-in"><span><span class="co"># Random generation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bgpg</span>, type <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.evpost-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

