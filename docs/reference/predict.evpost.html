<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predictive inference for the largest value observed in N years. — predict.evpost • revdbayes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predictive inference for the largest value observed in N years. — predict.evpost" />
<meta property="og:description" content="predict method for class &quot;evpost&quot;.  Performs predictive inference
about the largest value to be observed over a future time period of
N years.  Predictive inferences accounts for uncertainty in model
parameters and for uncertainty owing to the variability of future
observations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using the K-gaps model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/paulnorthrop/revdbayes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predictive inference for the largest value observed in N years.</h1>
    <small class="dont-index">Source: <a href='https://github.com/paulnorthrop/revdbayes/blob/master/R/predictive.R'><code>R/predictive.R</code></a></small>
    <div class="hidden name"><code>predict.evpost.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>predict</code> method for class "evpost".  Performs predictive inference
about the largest value to be observed over a future time period of
N years.  Predictive inferences accounts for uncertainty in model
parameters and for uncertainty owing to the variability of future
observations.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for evpost</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(
  <span class='no'>object</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"i"</span>, <span class='st'>"p"</span>, <span class='st'>"d"</span>, <span class='st'>"q"</span>, <span class='st'>"r"</span>),
  <span class='kw'>x</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>x_num</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>npy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>95</span>,
  <span class='kw'>hpd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>lower_tail</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>big_q</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class "evpost", a result of a call to
<code><a href='rpost.html'>rpost</a></code> or <code><a href='rpost_rcpp.html'>rpost_rcpp</a></code> with <code>model = "gev"</code>,
<code>model = "os"</code>, <code>model = "pp"</code> or <code>model == "bingp"</code>.
Calling these functions after a call to <code>rpost</code> or <code>rpost_rcpp</code>
with <code>model == "gp"</code> will produce an error, because inferences about
the probability of threshold exceedance are required, in addition to the
distribution of threshold excesses. The model is stored in
<code>object$model</code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A character vector.  Indicates which type of inference is
  required:</p><ul>
<li><p>"i" for predictive intervals,</p></li>
<li><p>"p" for the predictive distribution function,</p></li>
<li><p>"d" for the predictive density function,</p></li>
<li><p>"q" for the predictive quantile function,</p></li>
<li><p>"r" for random generation from the predictive distribution.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A numeric vector or a matrix with <code>n_years</code> columns.
  The meaning of <code>x</code> depends on <code>type</code>.</p><ul>
<li><p><code>type = "p"</code> or <code>type = "d"</code>: <code>x</code> contains
      quantiles at which to evaluate the distribution or density function.</p>
<p>If <code>object$model == "bingp"</code> then no element of <code>x</code> can be
      less than the threshold <code>object$thresh</code>.</p>
<p>If <code>x</code> is not supplied then <code>n_year</code>-specific defaults are
      set: vectors of length <code>x_num</code> from the 0.1% quantile to the
      99% quantile, subject all values being greater than the threshold.</p></li>
<li><p><code>type = "q"</code>: <code>x</code> contains probabilities in (0,1)
      at which to evaluate the quantile function.  Any values outside
      (0, 1) will be removed without warning.</p>
<p>If <code>object$model == "bingp"</code> then no element of <code>p</code> can
      correspond to a predictive quantile that is below the threshold,
      <code>object$thresh</code>.  That is, no element of <code>p</code> can be less
      than the value of <code>predict.evpost(object,</code>
      <code>type = "q", x = object$thresh)</code>.</p>
<p>If <code>x</code> is not supplied then a default value of
      <code><a href='https://rdrr.io/r/base/c.html'>c(0.025, 0.25, 0.5, 0.75, 0.975)</a></code> is used.</p></li>
<li><p><code>type = "i"</code> or <code>type = "r"</code>: <code>x</code> is not relevant.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>x_num</th>
      <td><p>A numeric scalar.  If <code>type = "p"</code> or <code>type = "d"</code>
and <code>x</code> is not supplied then <code>x_num</code> gives the number of values
in <code>x</code> for each value in <code>n_years</code>.</p></td>
    </tr>
    <tr>
      <th>n_years</th>
      <td><p>A numeric vector. Values of N.</p></td>
    </tr>
    <tr>
      <th>npy</th>
      <td><p>A numeric scalar. The mean number of observations per year
  of data, after excluding any missing values, i.e. the number of
  non-missing observations divided by total number of years of non-missing
  data.</p>
<p>If <code>rpost</code> or <code>rpost_rcpp</code> was called with
<code>model == "bingp"</code> then <code>npy</code> must either have been supplied
in that call or be supplied here.</p>
<p>Otherwise, a default value will be assumed if <code>npy</code> is not supplied,
based on the value of <code>model</code> in the call to <code>rpost</code> or
<code>rpost_rcpp</code>:</p><ul>
<li><p><code>model = "gev"</code>: <code>npy</code> = 1, i.e. the data were
    annual maxima so the block size is one year.</p></li>
<li><p><code>model = "os"</code>: <code>npy</code> = 1, i.e. the data were
    annual order statistics so the block size is one year.</p></li>
<li><p><code>model = "pp"</code>:
    <code>npy</code> = <code><a href='https://rdrr.io/r/base/length.html'>length(x$data)</a></code> / <code>object$noy</code>,
    i.e. the value of <code>noy</code> used in the call to <code><a href='rpost.html'>rpost</a></code>
    or <code><a href='rpost_rcpp.html'>rpost_rcpp</a></code> is equated to a block size of one year.</p></li>
</ul><p>If <code>npy</code> is supplied twice then the value supplied here will be
used and a warning given.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>A numeric vector of values in (0, 100).
Only relevant when <code>type = "i"</code>.
Levels of predictive intervals for the largest value observed in
N years, i.e. level% predictive intervals are returned.</p></td>
    </tr>
    <tr>
      <th>hpd</th>
      <td><p>A logical scalar.
  Only relevant when <code>type = "i"</code>.</p>
<p>If <code>hpd = FALSE</code> then the interval is
  equi-tailed, with its limits produced by
  <code>predict.evpost(</code><code>object, type ="q", x = p)</code>,
  where <code>p = c((1-level/100)/2,</code> <code>(1+level/100)/2)</code>.</p>
<p>If <code>hpd = TRUE</code> then, in addition to the equi-tailed interval,
  the shortest possible level% interval is calculated.
  If the predictive distribution is unimodal then this
  is a highest predictive density (HPD) interval.</p></td>
    </tr>
    <tr>
      <th>lower_tail</th>
      <td><p>A logical scalar.
Only relevant when <code>type = "p"</code> or <code>type = "q"</code>.
If TRUE (default), (output or input) probabilities are
\(P[X \leq x]\), otherwise, \(P[X &gt; x]\).</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>A logical scalar.  Only relevant when <code>type = "d"</code>.
If TRUE the log-density is returned.</p></td>
    </tr>
    <tr>
      <th>big_q</th>
      <td><p>A numeric scalar.  Only relevant when <code>type = "q"</code>.
An initial upper bound for the desired quantiles to be passed to
<code><a href='https://rdrr.io/r/stats/uniroot.html'>uniroot</a></code> (its argument <code>upper</code>) in the
search for the predictive quantiles.  If this is not sufficiently large
then it is increased until it does provide an upper bound.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional optional arguments. At present no optional
arguments are used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "evpred", a list containing a subset of the
  following components:</p>
<dt>type</dt><dd><p>The argument <code>type</code> supplied to <code>predict.evpost</code>.
    Which of the following components are present depends <code>type</code>.</p></dd>
    <dt>x</dt><dd><p>A matrix containing the argument <code>x</code> supplied to
      <code>predict.evpost</code>, or set within <code>predict.evpost</code> if <code>x</code>
      was not supplied, replicated to have <code>n_years</code> columns
      if necessary.
      Only present if <code>type</code> is <code>"p", "d"</code> or <code>"q"</code>.</p></dd>
    <dt>y</dt><dd><p>The content of <code>y</code> depends on <code>type</code>:
    <ul>
<li><p><code>type = "p", "d", "q"</code>:  A matrix with the same
      dimensions as <code>x</code>.  Contains distribution function values
      (<code>type = "p"</code>), predictive density (<code>type = "d"</code>)
      or quantiles (<code>type = "q"</code>).</p></li>
<li><p><code>type = "r"</code>: A numeric matrix with <code><a href='https://rdrr.io/r/base/length.html'>length(n_years)</a></code>
      columns and number of rows equal to the size of the posterior sample.</p></li>
<li><p><code>type = "i"</code>: <code>y</code> is not present.</p></li>
</ul></p></dd>
      <dt>long</dt><dd><p>A <code>length(n_years)*length(level)</code> by 4 numeric
        matrix containing the equi-tailed limits with columns:
        lower limit, upper limit, n_years, level.
        Only present if <code>type = "i"</code>.  If an interval extends below
        the threshold then <code>NA</code> is returned.</p></dd>
      <dt>short</dt><dd><p>A matrix with the same structure as <code>long</code>
        containing the HPD limits.  Only present if <code>type = "i"</code>.
        Columns 1 and 2 contain <code>NA</code>s if <code>hpd = FALSE</code>
        or if the corresponding equi-tailed interval extends below
        the threshold.</p></dd>
  The arguments n_years, level, hpd, lower_tail, log supplied
  to predict.evpost are also included, as is the argument npy
  supplied to, or set within, predict.evpost and
  the arguments data and model from the original call to
  <a href='rpost.html'>rpost</a> or <a href='rpost_rcpp.html'>rpost_rcpp</a>.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Inferences about future extreme observations are integrated over
  the posterior distribution of the model parameters, thereby accounting
  for uncertainty in model parameters and uncertainty owing to the
  variability of future observations.  In practice the integrals involved
  are estimated using an empirical mean over the posterior sample.
  See, for example,
  <a href='https://doi.org/10.1007/978-1-4471-3675-0_9'>Coles (2001),
  chapter 9</a>,
  <a href='https://doi.org/10.1201/b19721'>Stephenson (2016)</a>
  or
  <a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>
  for details.
  See also the vignette
  <a href='https://CRAN.R-project.org/package=revdbayes'>Posterior Predictive Extreme Value Inference</a></p>
<p><strong>GEV / OS / PP</strong>.
  If <code>model = "gev"</code>, <code>model = "os"</code> or <code>model = "pp"</code>
  in the call to <code><a href='rpost.html'>rpost</a></code> or <code><a href='rpost_rcpp.html'>rpost_rcpp</a></code>
  we first calculate the number of blocks \(b\) in <code>n_years</code> years.
  To calculate the density function or distribution function of the maximum
  over <code>n_years</code> we call <code><a href='gev.html'>dgev</a></code> or <code><a href='gev.html'>pgev</a></code>
  with <code>m</code> = \(b\).</p>
<p></p><ul>
<li><p><code>type = "p"</code>. We calculate using <code><a href='gev.html'>pgev</a></code>
    the GEV distribution function at <code>q</code> for each of the posterior
    samples of the location, scale and shape parameters.  Then we take
    the mean of these values.</p></li>
<li><p><code>type = "d"</code>. We calculate using <code><a href='gev.html'>dgev</a></code>
    the GEV density function at <code>x</code> for each of the posterior samples
    of the location, scale and shape parameters.  Then we take the
    mean of these values.</p></li>
<li><p><code>type = "q"</code>. We solve numerically
    <code>predict.evpost(object, type = "p", x = q)</code> = <code>p[i]</code>
    numerically for <code>q</code> for each element <code>p[i]</code> of <code>p</code>.</p></li>
<li><p><code>type = "i"</code>. If <code>hpd = FALSE</code> then the interval is
    equi-tailed, equal to <code>predict.evpost()</code> <code>object, type ="q", x = p)</code>,
    where <code>p = c((1-level/100)/2,</code> <code>(1+level/100)/2)</code>.
    If <code>hpd = TRUE</code> then, in addition, we perform a
    numerical minimisation of the length of level% intervals, after
    approximating the predictive quantile function using monotonic
    cubic splines, to reduce computing time.</p></li>
<li><p><code>type = "r"</code>. For each simulated value of the GEV parameters
    at the <code>n_years</code> level of aggregation we simulate one value from
    this GEV distribution using <code><a href='gev.html'>rgev</a></code>.  Thus, each sample
    from the predictive distribution is of a size equal to the size of
    the posterior sample.</p></li>
</ul>

<p><strong>Binomial-GP</strong>.  If <code>model = "bingp"</code> in the call to
  <code><a href='rpost.html'>rpost</a></code> or <code><a href='rpost_rcpp.html'>rpost_rcpp</a></code> then we calculate the
  mean number of observations in <code>n_years</code> years, i.e.
  <code>npy * n_years</code>.</p>
<p>Following <a href='https://doi.org/10.1111/rssc.12159'>Northrop et al. (2017)</a>
  let \(M_N\) be the largest value observed in \(N\) years,
  \(m\) = <code>npy * n_years</code> and \(u\) the threshold
  <code>object$thresh</code> used in the call to <code>rpost</code>
  or <code>rpost_rcpp</code>.
  For fixed values of \(\theta = (p, \sigma, \xi)\) the distribution
  function of \(M_N\) is given by \(F(z, \theta)^m\), for
  \(z \geq u\), where
  $$F(z, \theta) = 1 - p [1 + \xi (x - u) / \sigma] ^ {-1/\xi}.$$
  The distribution function of \(M_N\) cannot be evaluated for
  \(z &lt; u\) because no model has been supposed for observations below
  the threshold.</p>
<ul>
<li><p><code>type = "p"</code>. We calculate
    \(F(z, \theta)^m\) at <code>q</code> for each of the posterior samples
    \(\theta\).  Then we take the mean of these values.</p></li>
<li><p><code>type = "d"</code>.  We calculate the density of of \(M_n\), i.e.
    the derivative of \(F(z, \theta)^m\) with respect to \(z\) at
    <code>x</code> for each of the posterior samples \(\theta\).  Then we take
    the mean of these values.</p></li>
<li><p><code>type = "q"</code> and <code>type = "i"</code> We perform calculations
    that are analogous to the GEV case above.  If <code>n_years</code> is very
    small and/or level is very close to 100 then a predictive interval
    may extend below the threshold.  In such cases <code>NA</code>s are returned
    (see <strong>Value</strong> below).</p></li>
<li><p><code>type = "r"</code>.  For each simulated value of the bin-GP
    parameter we simulate from the distribution of \(M_N\) using the
    inversion method applied to the distribution function of \(M_N\) given
    above.  Occasionally a value below the threshold would need to be
    simulated.  If these instances a missing value code <code>NA</code> is
    returned. Thus, each sample from the predictive distribution is of a
    size equal to the size of the posterior sample, perhaps with a small
    number os <code>NA</code>s.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  Chapter 9: <a href='https://doi.org/10.1007/978-1-4471-3675-0_9'>https://doi.org/10.1007/978-1-4471-3675-0_9</a></p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
  Cross-validatory extreme value threshold selection and uncertainty
  with application to ocean storm severity.
  <em>Journal of the Royal Statistical Society Series C: Applied
  Statistics</em>, <strong>66</strong>(1), 93-120.
  <a href='https://doi.org/10.1111/rssc.12159'>https://doi.org/10.1111/rssc.12159</a></p>
<p>Stephenson, A. (2016). Bayesian Inference for Extreme Value
  Modelling. In <em>Extreme Value Modeling and Risk Analysis: Methods and
  Applications</em>, edited by D. K. Dey and J. Yan, 257-80. London:
  Chapman and Hall. <a href='https://doi.org/10.1201/b19721'>https://doi.org/10.1201/b19721</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.evpred.html'>plot.evpred</a></code> for the S3 <code>plot</code> method for
  objects of class <code>evpred</code>.</p>
<p><code><a href='rpost.html'>rpost</a></code> or <code><a href='rpost_rcpp.html'>rpost_rcpp</a></code> for sampling
  from an extreme value posterior distribution.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### GEV</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>portpirie</span>)
<span class='no'>mat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10000</span>, <span class='fl'>10000</span>, <span class='fl'>100</span>))
<span class='no'>pn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='kw'>prior</span> <span class='kw'>=</span> <span class='st'>"norm"</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"gev"</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>cov</span> <span class='kw'>=</span> <span class='no'>mat</span>)
<span class='no'>gevp</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='rpost_rcpp.html'>rpost_rcpp</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"gev"</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>pn</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>portpirie</span>)

<span class='co'># Interval estimation</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>)$<span class='no'>long</span></div><div class='output co'>#&gt;         lower    upper n_years level
#&gt; [1,] 4.451872 6.034953     100    95</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>hpd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)$<span class='no'>short</span></div><div class='output co'>#&gt;         lower    upper n_years level
#&gt; [1,] 4.368314 5.703984     100    95</div><div class='input'><span class='co'># Density function</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>:<span class='fl'>7</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"d"</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>)$<span class='no'>y</span></div><div class='output co'>#&gt;              [,1]
#&gt; [1,] 1.402124e-13
#&gt; [2,] 7.954246e-01
#&gt; [3,] 4.694612e-02
#&gt; [4,] 7.371214e-03</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"d"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>)))</div><div class='img'><img src='predict.evpost-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Distribution function</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>)$<span class='no'>y</span></div><div class='output co'>#&gt;              [,1]
#&gt; [1,] 8.241283e-16
#&gt; [2,] 7.271782e-01
#&gt; [3,] 9.734226e-01
#&gt; [4,] 9.935106e-01</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>)))</div><div class='img'><img src='predict.evpost-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Quantiles</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"q"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>))$<span class='no'>y</span></div><div class='output co'>#&gt;          [,1]     [,2]
#&gt; [1,] 4.451872 4.687935
#&gt; [2,] 4.641380 4.925375
#&gt; [3,] 4.794257 5.168235
#&gt; [4,] 5.030091 5.574250
#&gt; [5,] 6.034953 7.434204</div><div class='input'><span class='co'># Random generation</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>gevp</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"r"</span>))</div><div class='img'><img src='predict.evpost-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Binomial-GP</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>gom</span>)
<span class='no'>u</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>gom</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fl'>0.65</span>)
<span class='no'>fp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_prior.html'>set_prior</a></span>(<span class='kw'>prior</span> <span class='kw'>=</span> <span class='st'>"flat"</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"gp"</span>, <span class='kw'>min_xi</span> <span class='kw'>=</span> -<span class='fl'>1</span>)
<span class='no'>bp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_bin_prior.html'>set_bin_prior</a></span>(<span class='kw'>prior</span> <span class='kw'>=</span> <span class='st'>"jeffreys"</span>)
<span class='no'>npy_gom</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>gom</span>)/<span class='fl'>105</span>
<span class='no'>bgpg</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rpost_rcpp.html'>rpost_rcpp</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"bingp"</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>fp</span>, <span class='kw'>thresh</span> <span class='kw'>=</span> <span class='no'>u</span>,
                   <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>gom</span>, <span class='kw'>bin_prior</span> <span class='kw'>=</span> <span class='no'>bp</span>)

<span class='co'># Setting npy in call to predict.evpost()</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>npy</span> <span class='kw'>=</span> <span class='no'>npy_gom</span>)$<span class='no'>long</span></div><div class='output co'>#&gt;         lower    upper n_years level
#&gt; [1,] 10.44326 42.73159     100    95</div><div class='input'>
<span class='co'># Setting npy in call to rpost() or rpost_rcpp()</span>
<span class='no'>bgpg</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rpost_rcpp.html'>rpost_rcpp</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"bingp"</span>, <span class='kw'>prior</span> <span class='kw'>=</span> <span class='no'>fp</span>, <span class='kw'>thresh</span> <span class='kw'>=</span> <span class='no'>u</span>,
                   <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>gom</span>, <span class='kw'>bin_prior</span> <span class='kw'>=</span> <span class='no'>bp</span>, <span class='kw'>npy</span> <span class='kw'>=</span> <span class='no'>npy_gom</span>)

<span class='co'># Interval estimation</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>)$<span class='no'>long</span></div><div class='output co'>#&gt;        lower    upper n_years level
#&gt; [1,] 10.4245 42.61171     100    95</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>hpd</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)$<span class='no'>short</span></div><div class='output co'>#&gt;         lower    upper n_years level
#&gt; [1,] 9.006445 34.08054     100    95</div><div class='input'><span class='co'># Density function</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"d"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>)))</div><div class='img'><img src='predict.evpost-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Distribution function</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>)))</div><div class='img'><img src='predict.evpost-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Quantiles</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"q"</span>, <span class='kw'>n_years</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>1000</span>))$<span class='no'>y</span></div><div class='output co'>#&gt;          [,1]     [,2]
#&gt; [1,] 10.42450 15.19386
#&gt; [2,] 13.33113 19.80258
#&gt; [3,] 15.88546 24.78544
#&gt; [4,] 20.09481 34.01799
#&gt; [5,] 42.61171 91.07272</div><div class='input'><span class='co'># Random generation</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span>(<span class='no'>bgpg</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"r"</span>))</div><div class='img'><img src='predict.evpost-6.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


