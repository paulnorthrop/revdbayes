<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Random sampling from K-gaps posterior distribution — kgaps_post • revdbayes</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Random sampling from K-gaps posterior distribution — kgaps_post" />
<meta property="og:description" content="Uses the rust package to simulate from the posterior
distribution of the extremal index \(\theta\) based on the K-gaps model
for threshold interexceedance times of Suveges and Davison (2010)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using the K-gaps model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/paulnorthrop/revdbayes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Random sampling from K-gaps posterior distribution</h1>
    <small class="dont-index">Source: <a href='http://github.com/paulnorthrop/revdbayes/blob/master/R/kgaps.R'><code>R/kgaps.R</code></a></small>
    <div class="hidden name"><code>kgaps_post.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses the <code><a href='https://rdrr.io/pkg/rust/man/rust.html'>rust</a></code> package to simulate from the posterior
distribution of the extremal index \(\theta\) based on the K-gaps model
for threshold interexceedance times of Suveges and Davison (2010).</p>
    </div>

    <pre class="usage"><span class='fu'>kgaps_post</span>(
  <span class='no'>data</span>,
  <span class='no'>thresh</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>inc_cens</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>beta</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"logit"</span>, <span class='st'>"theta"</span>),
  <span class='kw'>use_rcpp</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A numeric vector of raw data.  No missing values are allowed.</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>A numeric scalar.  Extreme value threshold applied to data.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>A numeric scalar.  Run parameter \(K\), as defined in Suveges and
Davison (2010).  Threshold inter-exceedances times that are not larger
than <code>k</code> units are assigned to the same cluster, resulting in a
\(K\)-gap equal to zero.  Specifically, the \(K\)-gap \(S\)
corresponding to an inter-exceedance time of \(T\) is given by
\(S = max(T - K, 0)\).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>A numeric scalar. The size of posterior sample required.</p></td>
    </tr>
    <tr>
      <th>inc_cens</th>
      <td><p>A logical scalar indicating whether or not to include
contributions from censored inter-exceedance times relating to the
first and last observation.  See Attalides (2015) for details.</p></td>
    </tr>
    <tr>
      <th>alpha, beta</th>
      <td><p>Positive numeric scalars.  Parameters of a
beta(\(\alpha\), \(\beta\)) prior for \(\theta\).</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A character scalar.  If <code>param = "logit"</code> (the default)
then we simulate from the posterior distribution of
\(\phi = \log(\theta / (1-\theta))\)
and then transform back to the
\(\theta\)-scale.  If <code>param = "theta"</code> then we simulate
directly from the posterior distribution of \(\theta\), unless
the sample K-gaps are all equal to zero or all positive, when we revert
to <code>param = "logit"</code>.  This is to avoid sampling directly from a
posterior with mode equal to 0 or 1.</p></td>
    </tr>
    <tr>
      <th>use_rcpp</th>
      <td><p>A logical scalar.  If <code>TRUE</code> (the default) the
rust function <code><a href='https://rdrr.io/pkg/rust/man/ru_rcpp.html'>ru_rcpp</a></code> is used for
posterior simulation.  If <code>FALSE</code> the (slower) function
<code><a href='https://rdrr.io/pkg/rust/man/ru.html'>ru</a></code> is used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object (list) of class <code>"evpost"</code>, which has the same
  structure as an object of class <code>"ru"</code> returned from
  <code><a href='https://rdrr.io/pkg/rust/man/ru.html'>ru</a></code>.
  In addition this list contains</p><ul>
<li><p><code>model</code>: The character scalar <code>"kgaps"</code>.</p></li>
<li><p><code>thresh</code>: The argument <code>thresh</code>.</p></li>
<li><p><code>ss</code>: The sufficient statistics for the K-gaps likelihood,
      as calculated by <code><a href='kgaps_stats.html'>kgaps_stats</a></code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A beta(\(\alpha\), \(\beta\)) prior distribution is used for
  \(\theta\) so that the posterior from which values are simulated is
  proportional to
  $$\theta ^ {2 N_1 + \alpha - 1} (1 - \theta) ^ {N_0 + \beta - 1}
    \exp\{- \theta q (S_0 + \cdots + S_N)\}.$$
  See <code><a href='kgaps_stats.html'>kgaps_stats</a></code> for a description of the variables
  involved in the contribution of the likelihood to this expression.</p>
<p>The <code><a href='https://rdrr.io/pkg/rust/man/ru.html'>ru</a></code> function in the <code><a href='https://rdrr.io/pkg/rust/man/rust.html'>rust</a></code>
  package simulates from this posterior distribution using the
  generalised ratio-of-uniforms distribution.  To improve the probability
  of acceptance, and to ensure that the simulation will work even in
  extreme cases where the posterior density of \(\theta\) is unbounded as
  \(\theta\) approaches 0 or 1, we simulate from the posterior
  distribution of
  \(\phi = \log(\theta / (1-\theta))\)
  and then transform back to the \(\theta\)-scale.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Suveges, M. and Davison, A. C. (2010) Model
  misspecification in peaks over threshold analysis, <em>The Annals of
  Applied Statistics</em>, <strong>4</strong>(1), 203-221.
  <a href='https://doi.org/10.1214/09-AOAS292'>https://doi.org/10.1214/09-AOAS292</a></p>
<p>Attalides, N. (2015) Threshold-based extreme value modelling,
  PhD thesis, University College London.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='kgaps_mle.html'>kgaps_mle</a></code> for maximum likelihood estimation of the
  extremal index \(\theta\) using the K-gaps model.</p>
<p><code><a href='kgaps_stats.html'>kgaps_stats</a></code> for the calculation of sufficient
  statistics for the K-gaps model.</p>
<p><code><a href='https://rdrr.io/pkg/rust/man/ru.html'>ru</a></code> for the form of the object returned by
  <code>kgaps_post</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>thresh</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>newlyn</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fl'>0.90</span>)
<span class='no'>k_postsim</span> <span class='kw'>&lt;-</span> <span class='fu'>kgaps_post</span>(<span class='no'>newlyn</span>, <span class='no'>thresh</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>k_postsim</span>)</div><div class='img'><img src='kgaps_post-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


