<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Random sampling from extreme value posterior distributions — rpost_rcpp • revdbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Random sampling from extreme value posterior distributions — rpost_rcpp"><meta property="og:description" content="Uses the ru_rcpp function in the
rust package to simulate from the posterior distribution
of an extreme value model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">revdbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/EVA2021revdbayes.html">EVA 2021 R Workshop: revdbayes</a>
    </li>
    <li>
      <a href="../articles/ex1revdbayes.html">EVA 2021 revdbayes exercises 1</a>
    </li>
    <li>
      <a href="../articles/ex2revdbayes.html">EVA 2021 revdbayes exercises 2</a>
    </li>
    <li>
      <a href="../articles/revdbayes-a-vignette.html">Introducing revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</a>
    </li>
    <li>
      <a href="../articles/revdbayes-b-using-rcpp-vignette.html">Faster simulation using revdbayes</a>
    </li>
    <li>
      <a href="../articles/revdbayes-c-predictive-vignette.html">Posterior Predictive Extreme Value Inference using the revdbayes Package</a>
    </li>
    <li>
      <a href="../articles/revdbayes-d-kgaps-vignette.html">Inference for the extremal index using the K-gaps model</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/revdbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Random sampling from extreme value posterior distributions</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/revdbayes/blob/HEAD/R/rposterior_rcpp.R" class="external-link"><code>R/rposterior_rcpp.R</code></a></small>
    <div class="hidden name"><code>rpost_rcpp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Uses the <code><a href="https://paulnorthrop.github.io/rust/reference/ru_rcpp.html" class="external-link">ru_rcpp</a></code> function in the
<code><a href="https://paulnorthrop.github.io/rust/reference/rust.html" class="external-link">rust</a></code> package to simulate from the posterior distribution
of an extreme value model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">rpost_rcpp</span><span class="op">(</span>
  <span class="va">n</span>,
  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gev"</span>, <span class="st">"gp"</span>, <span class="st">"bingp"</span>, <span class="st">"pp"</span>, <span class="st">"os"</span><span class="op">)</span>,
  <span class="va">data</span>,
  <span class="va">prior</span>,
  <span class="va">...</span>,
  nrep <span class="op">=</span> <span class="cn">NULL</span>,
  thresh <span class="op">=</span> <span class="cn">NULL</span>,
  noy <span class="op">=</span> <span class="cn">NULL</span>,
  use_noy <span class="op">=</span> <span class="cn">TRUE</span>,
  npy <span class="op">=</span> <span class="cn">NULL</span>,
  ros <span class="op">=</span> <span class="cn">NULL</span>,
  bin_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"bin_beta"</span>, ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"binprior"</span><span class="op">)</span><span class="op">)</span>,
  init_ests <span class="op">=</span> <span class="cn">NULL</span>,
  mult <span class="op">=</span> <span class="fl">2</span>,
  use_phi_map <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>A numeric scalar. The size of posterior sample required.</p></dd>
<dt>model</dt>
<dd><p>A character string.  Specifies the extreme value model.</p></dd>
<dt>data</dt>
<dd><p>Sample data, of a format appropriate to the value of
<code>model</code>.</p><ul><li><p>"gp" A numeric vector of threshold excesses or raw data.</p></li>
<li><p>"bingp" A numeric vector of raw data.</p></li>
<li><p>"gev" A numeric vector of block maxima.</p></li>
<li><p>"pp" A numeric vector of raw data.</p></li>
<li><p>"os" A numeric matrix or data frame. Each row should contain
    the largest order statistics for a block of data.  These need not
    be ordered: they are sorted inside <code>rpost</code>. If a block
    contains fewer than <code>dim(as.matrix(data))[2]</code> order statistics
    then the corresponding row should be padded by <code>NA</code>s. If
    <code>ros</code> is supplied then only the largest <code>ros</code> values in
    each row are used.  If a vector is supplied then this is converted
    to a matrix with one column.  This is equivalent to using
    <code>model = "gev"</code>.</p></li>
</ul></dd>
<dt>prior</dt>
<dd><p>A list specifying the prior for the parameters of the extreme
value model, created by <code><a href="set_prior.html">set_prior</a></code>.</p></dd>
<dt>...</dt>
<dd><p>Further arguments to be passed to <code><a href="https://paulnorthrop.github.io/rust/reference/ru_rcpp.html" class="external-link">ru_rcpp</a></code>.
Most importantly <code>trans</code> and <code>rotate</code> (see <strong>Details</strong>),
and perhaps <code>r</code>, <code>ep</code>, <code>a_algor</code>, <code>b_algor</code>,
<code>a_method</code>, <code>b_method</code>, <code>a_control</code>, <code>b_control</code>.
May also be used to pass the arguments <code>n_grid</code> and/or <code>ep_bc</code>
to <code><a href="https://paulnorthrop.github.io/rust/reference/find_lambda.html" class="external-link">find_lambda</a></code>.</p></dd>
<dt>nrep</dt>
<dd><p>A numeric scalar.  If <code>nrep</code> is not <code>NULL</code> then
<code>nrep</code> gives the number of replications of the original dataset
simulated from the posterior predictive distribution.
Each replication is based on one of the samples from the posterior
distribution.  Therefore, <code>nrep</code> must not be greater than <code>n</code>.
In that event <code>nrep</code> is set equal to <code>n</code>.
Currently only implemented if <code>model = "gev"</code> or <code>"gp"</code> or
<code>"bingp"</code> or <code>"pp"</code>, i.e. <em>not</em> implemented if
<code>model = "os"</code>.</p></dd>
<dt>thresh</dt>
<dd><p>A numeric scalar.  Extreme value threshold applied to data.
Only relevant when <code>model = "gp"</code>, <code>"pp"</code> or <code>"bingp"</code>.
Must be supplied when <code>model = "pp"</code> or <code>"bingp"</code>.
If <code>model = "gp"</code> and <code>thresh</code> is not supplied then
<code>thresh = 0</code> is used and <code>data</code> should contain threshold
excesses.</p></dd>
<dt>noy</dt>
<dd><p>A numeric scalar. The number of blocks of observations,
excluding any missing values.  A block is often a year.
Only relevant, and must be supplied, if <code>model = "pp"</code>.</p></dd>
<dt>use_noy</dt>
<dd><p>A logical scalar.  Only relevant if model is "pp".
If <code>use_noy = FALSE</code> then sampling is based on a likelihood in
which the number of blocks (years) is set equal to the number of threshold
excesses, to reduce posterior dependence between the parameters
(Wadsworth <em>et al</em>., 2010).
The sampled values are transformed back to the required parameterisation
before returning them to the user.  If <code>use_noy = TRUE</code> then the
user's value of <code>noy</code> is used in the likelihood.</p></dd>
<dt>npy</dt>
<dd><p>A numeric scalar. The mean number of observations per year
  of data, after excluding any missing values, i.e. the number of
  non-missing observations divided by total number of years' worth of
  non-missing data.</p>
<p>The value of <code>npy</code> does not affect any calculation in
  <code>rpost</code>, it only affects subsequent extreme value inferences using
  <code>predict.evpost</code>.  However, setting <code>npy</code> in the call to
  <code>rpost</code> avoids the need to supply <code>npy</code> when calling
  <code>predict.evpost</code>.  This is likely to be useful only when
  <code>model = bingp</code>. See the documentation of
  <code><a href="predict.evpost.html">predict.evpost</a></code> for further details.</p></dd>
<dt>ros</dt>
<dd><p>A numeric scalar.  Only relevant when <code>model = "os"</code>. The
largest <code>ros</code> values in each row of the matrix <code>data</code> are used
in the analysis.</p></dd>
<dt>bin_prior</dt>
<dd><p>A list specifying the prior for a binomial probability
\(p\), created by <code><a href="set_bin_prior.html">set_bin_prior</a></code>.  Only relevant if
<code>model = "bingp"</code>.  If this is not supplied then the Jeffreys
beta(1/2, 1/2) prior is used.</p></dd>
<dt>init_ests</dt>
<dd><p>A numeric vector.  Initial parameter estimates for search
for the mode of the posterior distribution.</p></dd>
<dt>mult</dt>
<dd><p>A numeric scalar.  The grid of values used to choose the Box-Cox
transformation parameter lambda is based on the maximum a posteriori (MAP)
estimate +/- mult x estimated posterior standard deviation.</p></dd>
<dt>use_phi_map</dt>
<dd><p>A logical scalar. If trans = "BC" then <code>use_phi_map</code>
determines whether the grid of values for phi used to set lambda is
centred on the maximum a posterior (MAP) estimate of phi
(<code>use_phi_map = TRUE</code>), or on the initial estimate of phi
(<code>use_phi_map = FALSE</code>).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object (list) of class <code>"evpost"</code>, which has the same
  structure as an object of class <code>"ru"</code> returned from
<code><a href="https://paulnorthrop.github.io/rust/reference/ru_rcpp.html" class="external-link">ru_rcpp</a></code>.  In addition this list contains</p><ul><li><p><code>model</code>: The argument <code>model</code> to <code>rpost</code>
      detailed above.</p></li>
<li><p><code>data</code>: The content depends on <code>model</code>:
      if <code>model = "gev"</code> then this is the argument <code>data</code> to
      <code>rpost</code> detailed above, with missing values removed;
      if <code>model = "gp"</code> then only the values that lie above the
      threshold are included; if <code>model = "bingp"</code> or
      <code>model = "pp"</code> then the input data are returned
      but any value lying below the threshold is set to <code>thresh</code>;
      if <code>model = "os"</code> then the order statistics used are returned
      as a single vector.</p></li>
<li><p><code>prior</code>: The argument <code>prior</code> to <code>rpost</code>
      detailed above.</p></li>
<li><p><code>logf_rho_args</code>: A list of arguments to the (transformed)
      target log-density.</p></li>
</ul><p>If <code>nrep</code> is not <code>NULL</code> then this list also contains
<code>data_rep</code>, a numerical matrix with <code>nrep</code> rows.  Each
  row contains a replication of the original data <code>data</code>  simulated from the posterior predictive distribution.
  If <code>model = "bingp"</code> or <code>"pp"</code> then the rate of threshold
  exceedance is part of the inference.  Therefore, the number of values in
<code>data_rep</code> that lie above the threshold varies between
  predictive replications (different rows of <code>data_rep</code>).
  Values below the threshold are left-censored at the threshold, i.e. they
  are set at the threshold.
  If <code>model == "pp"</code> then this list also contains the argument
<code>noy</code> to <code>rpost</code> detailed above.
  If the argument <code>npy</code> was supplied then this list also contains
<code>npy</code>.
  If <code>model == "gp"</code> or <code>model == "bingp"</code> then this list also
    contains the argument <code>thresh</code> to <code>rpost</code> detailed above.
  If <code>model == "bingp"</code> then this list also contains</p><ul><li><p><code>bin_sim_vals</code>: An <code>n</code> by 1 numeric matrix of values
      simulated from the posterior for the binomial
      probability \(p\)</p></li>
<li><p><code>bin_logf</code>: A function returning the log-posterior for
      \(p\).</p></li>
<li><p><code>bin_logf_args</code>: A list of arguments to <code>bin_logf</code>.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>Generalised Pareto (GP)</em>: <code>model = "gp"</code>.  A model for threshold
  excesses.  Required arguments: <code>n</code>, <code>data</code> and <code>prior</code>.
  If <code>thresh</code> is supplied then only the values in <code>data</code> that
  exceed <code>thresh</code> are used and the GP distribution is fitted to the
  amounts by which those values exceed <code>thresh</code>.
  If <code>thresh</code> is not supplied then the GP distribution is fitted to
  all values in <code>data</code>, in effect <code>thresh = 0</code>.
  See also <code><a href="gp.html">gp</a></code>.</p>
<p><em>Binomial-GP</em>: <code>model = "bingp"</code>.  The GP model for threshold
  excesses supplemented by a binomial(<code>length(data)</code>, \(p\))
  model for the number of threshold excesses.  See Northrop et al. (2017)
  for details.  Currently, the GP and binomial parameters are assumed to
  be independent <em>a priori</em>.</p>
<p><em>Generalised extreme value (GEV) model</em>: <code>model = "gev"</code>.  A
  model for block maxima.  Required arguments: <code>n</code>, <code>data</code>,
  <code>prior</code>.  See also <code><a href="gev.html">gev</a></code>.</p>
<p><em>Point process (PP) model</em>: <code>model = "pp"</code>. A model for
  occurrences of threshold exceedances and threshold excesses.  Required
  arguments: <code>n</code>, <code>data</code>, <code>prior</code>, <code>thresh</code> and
  <code>noy</code>.</p>
<p><em>r-largest order statistics (OS) model</em>: <code>model = "os"</code>.
  A model for the largest order statistics within blocks of data.
  Required arguments: <code>n</code>, <code>data</code>, <code>prior</code>.  All the values
  in <code>data</code> are used unless <code>ros</code> is supplied.</p>
<p><em>Parameter transformation</em>.  The scalar logical arguments (to the
  function <code>ru</code>) <code>trans</code> and <code>rotate</code> determine,
  respectively, whether or not Box-Cox transformation is used to reduce
  asymmetry in the posterior distribution and rotation of parameter
  axes is used to reduce posterior parameter dependence.  The default
  is <code>trans = "none"</code> and <code>rotate = TRUE</code>.</p>
<p>See the <a href="https://CRAN.R-project.org/package=revdbayes" class="external-link">Introducing revdbayes vignette</a>
  for further details and examples.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Coles, S. G. and Powell, E. A. (1996) Bayesian methods in
  extreme value modelling: a review and new developments.
  <em>Int. Statist. Rev.</em>, <strong>64</strong>, 119-136.</p>
<p>Northrop, P. J., Attalides, N. and Jonathan, P. (2017)
  Cross-validatory extreme value threshold selection and uncertainty
  with application to ocean storm severity.
  <em>Journal of the Royal Statistical Society Series C: Applied
  Statistics</em>, <strong>66</strong>(1), 93-120.
  doi: <a href="https://doi.org/10.1111/rssc.12159" class="external-link">10.1111/rssc.12159</a></p>
<p>Stephenson, A. (2016) Bayesian Inference for Extreme Value
  Modelling. In <em>Extreme Value Modeling and Risk Analysis: Methods and
  Applications</em>, edited by D. K. Dey and J. Yan, 257-80. London:
  Chapman and Hall. doi: <a href="https://doi.org/10.1201/b19721" class="external-link">10.1201/b19721</a>

  value posterior using the evdbayes package.</p>
<p>Wadsworth, J. L., Tawn, J. A. and Jonathan, P. (2010)
  Accounting for choice of measurement scale in extreme value modeling.
 <em>The Annals of Applied Statistics</em>, <strong>4</strong>(3), 1558-1578.
  doi: <a href="https://doi.org/10.1214/10-AOAS333" class="external-link">10.1214/10-AOAS333</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="set_prior.html">set_prior</a></code> for setting a prior distribution.</p>
<p><code><a href="rpost.html">rpost</a></code> for posterior simulation without using
  the Rcpp package.</p>
<p><code><a href="plot.evpost.html">plot.evpost</a></code>, <code><a href="summary.evpost.html">summary.evpost</a></code> and
  <code><a href="predict.evpost.html">predict.evpost</a></code> for the S3 <code>plot</code>, <code>summary</code>
  and <code>predict</code> methods for objects of class <code>evpost</code>.</p>
<p><code><a href="https://paulnorthrop.github.io/rust/reference/ru_rcpp.html" class="external-link">ru_rcpp</a></code> in the <code><a href="https://paulnorthrop.github.io/rust/reference/rust.html" class="external-link">rust</a></code>
  package for details of the arguments that can be passed to
  <code>ru_rcpp</code> and the form of the object returned by <code>rpost_rcpp</code>.</p>
<p><code><a href="https://paulnorthrop.github.io/rust/reference/find_lambda.html" class="external-link">find_lambda</a></code> in the
  <code><a href="https://paulnorthrop.github.io/rust/reference/rust.html" class="external-link">rust</a></code> package is used inside <code>rpost</code> to set the
  Box-Cox transformation parameter lambda when the <code>trans = "BC"</code>
  argument is given.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># GP model</span></span>
<span class="r-in"><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gpg</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span>
<span class="r-in">                  data <span class="op">=</span> <span class="va">gom</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gpg</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># GP model, user-defined prior (same prior as the previous example)</span></span>
<span class="r-in"><span class="va">ptr_gp_flat</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_prior_xptr.html">create_prior_xptr</a></span><span class="op">(</span><span class="st">"gp_flat"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p_user</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">ptr_gp_flat</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gpg</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">p_user</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span>
<span class="r-in">                  data <span class="op">=</span> <span class="va">gom</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gpg</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Binomial-GP model</span></span>
<span class="r-in"><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">gom</span>, probs <span class="op">=</span> <span class="fl">0.65</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gp"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_bin_prior.html">set_bin_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"jeffreys"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">bgpg</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"bingp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span>
<span class="r-in">                   data <span class="op">=</span> <span class="va">gom</span>, bin_prior <span class="op">=</span> <span class="va">bp</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpg</span>, pu_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpg</span>, add_pu <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Setting the same binomial (Jeffreys) prior by hand</span></span>
<span class="r-in"><span class="va">beta_prior_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">ab</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">p</span>, shape1 <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, shape2 <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">jeffreys</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_bin_prior.html">set_bin_prior</a></span><span class="op">(</span><span class="va">beta_prior_fn</span>, ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">bgpg</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"bingp"</span>, prior <span class="op">=</span> <span class="va">fp</span>, thresh <span class="op">=</span> <span class="va">u</span>,</span>
<span class="r-in">                   data <span class="op">=</span> <span class="va">gom</span>, bin_prior <span class="op">=</span> <span class="va">jeffreys</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpg</span>, pu_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bgpg</span>, add_pu <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># GEV model</span></span>
<span class="r-in"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pn</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gevp</span>  <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pn</span>, data <span class="op">=</span> <span class="va">portpirie</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gevp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># GEV model, user-defined prior (same prior as the previous example)</span></span>
<span class="r-in"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ptr_gev_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_prior_xptr.html">create_prior_xptr</a></span><span class="op">(</span><span class="st">"gev_norm"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pn_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">ptr_gev_norm</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span class="r-in">                  icov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gevu</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pn_u</span>, data <span class="op">=</span> <span class="va">portpirie</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gevu</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># GEV model, informative prior constructed on the probability scale</span></span>
<span class="r-in"><span class="va">pip</span>  <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">88</span>, <span class="fl">95</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2.5</span>, <span class="fl">2.25</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span class="r-in">  model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ox_post</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="va">pip</span>, data <span class="op">=</span> <span class="va">oxford</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ox_post</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># PP model</span></span>
<span class="r-in"><span class="va">pf</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flat"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ppr</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">pf</span>, data <span class="op">=</span> <span class="va">rainfall</span>,</span>
<span class="r-in">                  thresh <span class="op">=</span> <span class="fl">40</span>, noy <span class="op">=</span> <span class="fl">54</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppr</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-10.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># PP model, user-defined prior (same prior as the previous example)</span></span>
<span class="r-in"><span class="va">ptr_gev_flat</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_prior_xptr.html">create_prior_xptr</a></span><span class="op">(</span><span class="st">"gev_flat"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pf_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="va">ptr_gev_flat</span>, model <span class="op">=</span> <span class="st">"gev"</span>, min_xi <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span class="r-in">                  max_xi <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ppru</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">pf_u</span>, data <span class="op">=</span> <span class="va">rainfall</span>,</span>
<span class="r-in">                   thresh <span class="op">=</span> <span class="fl">40</span>, noy <span class="op">=</span> <span class="fl">54</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppru</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-11.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># PP model, informative prior constructed on the quantile scale</span></span>
<span class="r-in"><span class="va">piq</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38.9</span>, <span class="fl">7.1</span>, <span class="fl">47</span><span class="op">)</span>,</span>
<span class="r-in">                 scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">6.3</span>, <span class="fl">2.6</span><span class="op">)</span>, model <span class="op">=</span> <span class="st">"gev"</span>, prior <span class="op">=</span> <span class="st">"quant"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rn_post</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"pp"</span>, prior <span class="op">=</span> <span class="va">piq</span>, data <span class="op">=</span> <span class="va">rainfall</span>,</span>
<span class="r-in">                      thresh <span class="op">=</span> <span class="fl">40</span>, noy <span class="op">=</span> <span class="fl">54</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rn_post</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-12.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># OS model</span></span>
<span class="r-in"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">10000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"norm"</span>, model <span class="op">=</span> <span class="st">"gev"</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, cov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">osv</span> <span class="op">&lt;-</span> <span class="fu">rpost_rcpp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, model <span class="op">=</span> <span class="st">"os"</span>, prior <span class="op">=</span> <span class="va">pv</span>, data <span class="op">=</span> <span class="va">venice</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">osv</span><span class="op">)</span></span>
<span class="r-plt img"><img src="rpost_rcpp-13.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

